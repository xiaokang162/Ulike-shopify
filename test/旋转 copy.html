<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Starfield Effect</title>
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: #000;
      overflow: hidden;
    }

    /* ğŸŒŒ æ˜Ÿæ˜Ÿå®¹å™¨æ•´ä½“æ—‹è½¬ */
    .star-wrap {
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      transform-style: preserve-3d;
      animation: rotate 250s linear infinite;
      backface-visibility: hidden;
    }

    /* ğŸŒŸ å•é¢—æ˜Ÿæ˜Ÿé—ªçƒ */
    .star {
      position: absolute;
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background-color: #b6cbd4;
      backface-visibility: hidden;
      transform: rotate(0deg) scale(0.08);
      animation: blink 15s ease infinite alternate both;
      z-index: 0;
    }

    /* æ˜Ÿæ˜Ÿå†…éƒ¨å…‰æ™•å±‚ */
    .star div {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      backface-visibility: hidden;
      box-shadow:
        0 0 2px 8px rgba(0, 0, 0, 0.4),
        0 0 2px 9px rgba(255, 255, 255, 0.07),
        0 0 2px 15px rgba(0, 0, 0, 0.4),
        0 0 2px 16px rgba(255, 255, 255, 0.1);
      transform: rotate(45deg) scale(0.75);
    }

    /* âœ´ï¸ å››ä¸ªåå­—å…‰çº¿ï¼ˆä¼ªå…ƒç´ ï¼‰ */
    .star::before,
    .star::after,
    .star div::before,
    .star div::after {
      content: "";
      position: absolute;
      border-radius: 50%;
      background: linear-gradient(to bottom,
          rgba(255, 255, 255, 0.1) 0%,
          rgba(255, 255, 255, 0.7) 50%,
          rgba(255, 255, 255, 0.1) 100%);
      box-shadow: 0 0 25px white;
      width: 10%;
      height: 800%;
      top: calc(50% - 400%);
      left: 45%;
      z-index: 1;
    }

    .star::before,
    .star div::before {
      transform: rotate(90deg);
    }

    /* ğŸ”µ è“è‰²æ˜Ÿæ˜Ÿå…‰æ™• */
    .star.star--blue::before,
    .star.star--blue::after,
    .star.star--blue div::before,
    .star.star--blue div::after {
      box-shadow: 0 0 25px #0000ff;
    }

    /* ğŸ”´ çº¢è‰²æ˜Ÿæ˜Ÿå…‰æ™• */
    .star.star--red::before,
    .star.star--red::after,
    .star.star--red div::before,
    .star.star--red div::after {
      box-shadow: 0 0 25px #ff0000;
    }

    /* âœ¨ é—ªçƒåŠ¨ç”» */
    @keyframes blink {
      0% {
        transform: rotate(0deg) scale(0.1);
      }

      4% {
        transform: rotate(-20deg) scale(0.9);
      }

      8% {
        transform: rotate(-40deg) scale(0.1);
      }

      50% {
        transform: rotate(-40deg) scale(0.1);
      }

      52% {
        transform: rotate(-50deg) scale(0.3);
      }

      54% {
        transform: rotate(-60deg) scale(0.1);
      }

      100% {
        transform: rotate(0deg) scale(0.1);
      }
    }

    /* ğŸŒ  å®¹å™¨æ—‹è½¬åŠ¨ç”» */
    @keyframes rotate {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .shoot-star {
      position: absolute;
      top: 100px;
      left: 400px;
      width: 2px;
      height: 2px;
      border-radius: 50%;
      /* background: #fff; */
      transform-origin: 100% 0;
      opacity: 0;
      animation: star-move 2.5s linear forwards;
    }

    .shoot-star::after {
      content: '';
      position: absolute;
      top: 20px;
      left: 2px;
      border: 1px solid #f00;
      border-width: 1px 150px 1px 150px;
      border-color: transparent transparent transparent #fff;
      transform: rotate(-45deg) translate3d(1px, -1px, 0);
      transform-origin: 0% 100%;
      opacity: 0;
      animation: shooting 2.5s linear forwards;
    }

    /* ğŸŒ  æµæ˜Ÿæ»‘åŠ¨è·¯å¾„ + æ¸éšæ•ˆæœ */
    @keyframes star-move {
      0% {
        opacity: 0;
        transform: scale(0.5) translate3d(200px, -200px, 0);
      }

      15% {
        opacity: 1;
      }

      80% {
        opacity: 1;
      }

      100% {
        opacity: 0;
        /* âœ… å°¾ç«¯æ…¢æ…¢æ¶ˆå¤± */
        transform: scale(1) translate3d(-200px, 200px, 0);
      }
    }

    /* ğŸŒ  å°¾å·´çš„å…‰çº¿éšä¸»ä½“åŒæ­¥æ·¡å‡º */
    @keyframes shooting {
      0% {
        opacity: 0;
        transform: scale(0.8) rotate(-45deg) translate(0px, 0px);
      }

      15% {
        opacity: 1;
      }

      80% {
        opacity: 1;
      }

      100% {
        opacity: 0;
        /* âœ… å°¾éƒ¨åŒæ—¶æ…¢æ…¢æ¶ˆå¤± */
        transform: scale(0.8) rotate(-45deg) translate(-5px, -5px);
      }
    }
  </style>
</head>

<body>
  <div class="star-sky">
  </div>
  <script>

    function initStarSky(options = {}) {
      const STAR_COUNT = options.starCount || 280;
      const SHOOT_INTERVAL_MIN = options.shootIntervalMin || 1000;
      const SHOOT_INTERVAL_MAX = options.shootIntervalMax || 4000;

      const sky = document.querySelector('.star-sky');
      if (!sky) return console.warn('âŒ æœªæ‰¾åˆ° .star-sky å…ƒç´ ');

      let wrap = sky.querySelector('.star-wrap');
      if (!wrap) {
        wrap = document.createElement('div');
        wrap.className = 'star-wrap';
        sky.appendChild(wrap);
      }

      // ğŸŒŸ åˆ›å»ºæ˜Ÿæ˜Ÿ
      for (let i = 0; i < STAR_COUNT; i++) {
        const star = document.createElement('div');
        star.classList.add('star');
        if (i % 8 === 0) star.classList.add('star--red');
        else if (i % 10 === 6) star.classList.add('star--blue');
        const inner = document.createElement('div');
        star.appendChild(inner);
        const size = (Math.random() * 2 + 7).toFixed(2) + 'px';
        star.style.width = size;
        star.style.height = size;
        star.style.top = (Math.random() * 100).toFixed(2) + '%';
        star.style.left = (Math.random() * 100).toFixed(2) + '%';
        star.style.opacity = (Math.random() * 0.5 + 0.5).toFixed(2);
        star.style.animationDelay = (Math.random() * 100).toFixed(2) + 's';
        wrap.appendChild(star);
      }

      // â˜„ï¸ åˆ›å»ºæµæ˜Ÿ
      function createShootStar() {
        const shootStar = document.createElement('div');
        shootStar.classList.add('shoot-star');
        // shootStar.style.top = (Math.random() * 40).toFixed(2) + '%';
        shootStar.style.left = (Math.random() * 100).toFixed(2) + '%';
        sky.appendChild(shootStar);
        shootStar.addEventListener('animationend', () => shootStar.remove());
      }

      // â˜„ï¸ éšæœºé—´éš”å¾ªç¯ç”Ÿæˆæµæ˜Ÿ
      let shootingTimer = null;

      function startRandomShooting() {
        if (document.hidden) return; // é¡µé¢ä¸å¯è§æ—¶æš‚åœ
        const delay =
          Math.random() * (SHOOT_INTERVAL_MAX - SHOOT_INTERVAL_MIN) +
          SHOOT_INTERVAL_MIN;
        shootingTimer = setTimeout(() => {
          createShootStar();
          startRandomShooting(); // å¾ªç¯
        }, delay);
      }

      // é¡µé¢å¯è§çŠ¶æ€å˜åŒ–æ—¶æ§åˆ¶æµæ˜Ÿç”Ÿæˆ
      document.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
          // é¡µé¢åˆ‡å›å‰å°ï¼Œç»§ç»­ç”Ÿæˆæµæ˜Ÿ
          startRandomShooting();
        } else {
          // é¡µé¢éšè—æ—¶åœæ­¢
          if (shootingTimer) clearTimeout(shootingTimer);
        }
      });

      // å¯åŠ¨å¾ªç¯
      startRandomShooting();
    }

    // è°ƒç”¨
    initStarSky({
      starCount: 480,
      shootIntervalMin: 1000,
      shootIntervalMax: 4000
    });

  </script>
</body>

</html>