<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- <link rel="stylesheet" href="./test/css/swiper.min.css"> -->
  <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" />
  <link rel="stylesheet" href="./css/theme.css" />
  <link rel="stylesheet" href="./css/comm.css" />
  <link rel="stylesheet" href="./css/result.css" />
  <!-- <script src="./test/js/swiper.min.js"></script> -->
  <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
  <script src="./js/jquery.min.js"></script>
</head>

<body>
  <a>
    <img src="./images47/a1.jpg" alt="">
  </a>

  <results-reviews-new>
    <div class="results-reviews-new">
      <div class="results-reviews-new-top">
        <div class="container">
          <h3 class="results-reviews-h3">Results and reviews for Ulike IPL Hair Removal.</h3>
          <div class="results-reviews-tab-cont">
            <div class="results-reviews-tab">
              <div class="results-reviews-tab-item active" data-type="0">Armpit</div>
              <div class="results-reviews-tab-item" data-type="1">face</div>
              <div class="results-reviews-tab-item" data-type="0">Armpit</div>
              <div class="results-reviews-tab-item" data-type="1">face</div>
              <div class="results-reviews-tab-item" data-type="0">Armpit</div>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="results-reviews-new-box">
          <div class="results-reviews-cont">
            <div class="results-reviews-filter">
              <div class="results-reviews-filter-cont">
                <div class="results-reviews-filter-top">
                  Filter By:
                  <span class="close-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" class="is-pc" width="21" height="20" viewBox="0 0 21 20"
                      fill="none">
                      <path d="M4.12988 13L10.1299 7L16.1299 13" stroke="#190A0A" stroke-miterlimit="10"
                        stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="is-mb" width="25" height="24" viewBox="0 0 25 24"
                      fill="none">
                      <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M17.287 7.29299C17.0917 7.09773 16.7752 7.09773 16.5799 7.29299L12.9404 10.9325L9.30086 7.29299C9.10559 7.09773 8.78901 7.09773 8.59375 7.29299L8.2402 7.64655C8.04493 7.84181 8.04493 8.15839 8.2402 8.35365L11.8797 11.9932L8.2402 15.6327C8.04493 15.828 8.04493 16.1445 8.2402 16.3398L8.59375 16.6934C8.78901 16.8886 9.10559 16.8886 9.30086 16.6934L12.9404 13.0538L16.5799 16.6934C16.7752 16.8886 17.0917 16.8886 17.287 16.6934L17.6406 16.3398C17.8358 16.1445 17.8358 15.828 17.6406 15.6327L14.001 11.9932L17.6406 8.35365C17.8358 8.15839 17.8358 7.84181 17.6406 7.64655L17.287 7.29299Z"
                        fill="#161823" />
                    </svg>
                  </span>
                </div>
                <div class="results-reviews-filter-tj">
                  <div class="results-reviews-filter-box">
                    <div class="results-reviews-filter-title">Product</div>
                    <div class="results-reviews-filter-list">
                      <div class="results-reviews-filter-item" data-txt="Air 10">
                        <label>
                          <input type="checkbox" name="productType" value="0" hidden>
                          <span></span>
                          Air 10
                        </label>
                      </div>
                      <div class="results-reviews-filter-item" data-txt="Air 3">
                        <label>
                          <input type="checkbox" name="productType" value="1" hidden>
                          <span></span>
                          Air 3
                        </label>
                      </div>
                      <div class="results-reviews-filter-item" data-txt="Ulike X">
                        <label>
                          <input type="checkbox" name="productType" value="2" hidden>
                          <span></span>
                          Ulike X
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="results-reviews-filter-box">
                    <div class="results-reviews-filter-title">Cyclicality</div>
                    <div class="results-reviews-filter-list">
                      <div class="results-reviews-filter-item" data-txt="Week 1-4">
                        <label>
                          <input type="checkbox" name="cyclicality" value="0" hidden>
                          <span></span>
                          Week 1-4
                        </label>
                      </div>
                      <div class="results-reviews-filter-item" data-txt="Week 5-8">
                        <label>
                          <input type="checkbox" name="cyclicality" value="1" hidden>
                          <span></span>
                          Week 5-8
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="results-reviews-filter-box">
                    <div class="results-reviews-filter-title">Skin Tone</div>
                    <div class="results-reviews-filter-list">
                      <div class="results-reviews-filter-item" data-txt="Light">
                        <label>
                          <input type="checkbox" name="skinTone" value="0" hidden>
                          <span></span>
                          Light
                        </label>
                      </div>
                      <div class="results-reviews-filter-item" data-txt="Medium">
                        <label>
                          <input type="checkbox" name="skinTone" value="1" hidden>
                          <span></span>
                          Medium
                        </label>
                      </div>
                      <div class="results-reviews-filter-item" data-txt="Dark">
                        <label>
                          <input type="checkbox" name="skinTone" value="2" hidden>
                          <span></span>
                          Dark
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="results-reviews-filter-btn">
                    <div class="results-reviews-filter-btn-item clear-filter-all">Clear</div>
                    <div class="results-reviews-filter-btn-item done-filter-popup is-mb">Done</div>
                  </div>
                </div>
                <div class="results-reviews-tags"></div>
              </div>
            </div>
            <div class="results-reviews-scroll">
              <div class="results-reviews-list">
                <div class="results-reviews-item">
                  <div class="results-reviews-item-img">
                    <div class="results-reviews-item-img-cont">
                      <img src="./images47/a1.jpg" class="img" alt="">
                    </div>
                  </div>
                  <div class="results-reviews-item-text">
                    <div class="results-reviews-start">
                      <img src="./images47/st.svg" alt="" class="start-img">
                      4.8
                    </div>
                    <div class="results-reviews-h4">It’s amazing!</div>
                    <div class="results-reviews-desc">“It’s amazing, I was able to recover my hair with this powerful
                      product. I don’t have extensions, and it feels so natural.”</div>
                    <div class="results-reviews-user">
                      <img src="./images47/user.png" alt="" class="user-img">
                      Kiara B.
                    </div>
                    <div class="results-reviews-product">
                      <img src="./images47/pro.png" alt="" class="pro-img">
                      <div class="results-reviews-product-txt">
                        <div class="results-reviews-product-name">Air 10</div>
                        <div class="results-reviews-product-price">
                          <span class="n-price">$299</span>
                          <span class="d-price">$429 </span>
                        </div>
                        <div class="results-reviews-product-btn">
                          Add to Cart
                          <svg xmlns="http://www.w3.org/2000/svg" width="15" height="12" viewBox="0 0 15 12"
                            fill="none">
                            <path d="M0.950195 5.8656L14.0372 5.86499" stroke="#190A0A" stroke-width="0.608696" />
                            <path d="M11.2979 3.12585L14.5032 5.86559L11.2979 8.53594" stroke="#190A0A"
                              stroke-width="0.608696" stroke-linejoin="round" />
                          </svg>
                        </div>
                      </div>
                    </div>
                    <div class="results-reviews-dz">
                      <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 41 41" fill="none">
                        <circle cx="20.9502" cy="20.865" r="19.5853" stroke="#EBEBEB" stroke-width="0.829368" />
                        <path
                          d="M17.0147 20.0521L20.2663 12.736C20.9131 12.736 21.5334 12.993 21.9907 13.4503C22.448 13.9076 22.705 14.5279 22.705 15.1747V18.4263H27.306C27.5417 18.4236 27.7751 18.4722 27.9901 18.5687C28.2051 18.6653 28.3966 18.8073 28.5512 18.9852C28.7059 19.163 28.82 19.3724 28.8857 19.5987C28.9514 19.8251 28.9672 20.063 28.9318 20.296L27.81 27.6121C27.7512 27.9997 27.5543 28.3531 27.2555 28.6071C26.9567 28.861 26.5763 28.9984 26.1842 28.994H17.0147M17.0147 20.0521V28.994M17.0147 20.0521H14.576C14.1448 20.0521 13.7313 20.2234 13.4264 20.5283C13.1215 20.8332 12.9502 21.2467 12.9502 21.6779V27.3682C12.9502 27.7994 13.1215 28.2129 13.4264 28.5178C13.7313 28.8227 14.1448 28.994 14.576 28.994H17.0147"
                          stroke="#190A0A" stroke-width="0.812899" stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                      208
                    </div>
                  </div>
                </div>
              </div>
              <div class="results-reviews-more">
                <div class="results-reviews-more-tap">
                  Load More
                  <svg xmlns="http://www.w3.org/2000/svg" width="15" height="11" viewBox="0 0 15 11" fill="none">
                    <path d="M0.450195 5.50061L13.5372 5.5" stroke="#E0004D" stroke-width="0.608696" />
                    <path d="M10.7979 2.76086L14.0032 5.5006L10.7979 8.17095" stroke="#E0004D" stroke-width="0.608696"
                      stroke-linejoin="round" />
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </results-reviews-new>
  <script>
    // class resultsReviews extends HTMLElement {
    //   constructor(el) {
    //     super();
    //     this.el = this;
    //     this.isChecking = false;
    //     this.filter = {
    //       type: 0,
    //       productType: [],
    //       cyclicality: [],
    //       skinTone: [],
    //       other: [],
    //       currentPage: 0,
    //       pageSize: 3
    //     }
    //     this.filterTag = []
    //     this.filterList = []
    //     this.data = [
    //       {
    //         id: '0',
    //         type: 0,
    //         productType: 0,
    //         cyclicality: 0,
    //         skinTone: 0,
    //         other: 0,
    //         img: './images47/a1.jpg',
    //         beforTxt: 'Before',
    //         afterTxt: 'After 1-4',
    //         video: '',
    //         starImg: './images47/st.svg',
    //         starTxt: '4.8',
    //         title: 'It’s amazing!',
    //         desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
    //         userImg: './images47/user.png',
    //         userName: 'Kiara B.',
    //         proImg: './images47/pro.png',
    //         proName: 'Air 10',
    //         proPrice: '$299',
    //         proPriceOld: '$429',
    //         proBtn: 'Add to Cart',
    //         proId: 132132,
    //         dzTxt: 208
    //       },
    //       {
    //         id: '1',
    //         type: 0,
    //         productType: 0,
    //         cyclicality: 0,
    //         skinTone: 0,
    //         img: './images47/a2.jpg',
    //         starImg: './images47/st.svg',
    //         starTxt: '4.8',
    //         title: 'It’s amazing!',
    //         desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
    //         userImg: './images47/user.png',
    //         userName: 'Kiara B.',
    //         proImg: './images47/pro.png',
    //         proName: 'Air 10',
    //         proPrice: '$299',
    //         proPriceOld: '$429',
    //         proBtn: 'Add to Cart',
    //         proId: 1321,
    //         dzTxt: 208
    //       },
    //       {
    //         id: '2',
    //         type: 0,
    //         productType: 2,
    //         cyclicality: 0,
    //         skinTone: 0,
    //         img: './images47/a3.jpg',
    //         starImg: './images47/st.svg',
    //         starTxt: '4.8',
    //         title: 'It’s amazing!',
    //         desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
    //         userImg: './images47/user.png',
    //         userName: 'Kiara B.',
    //         proImg: './images47/pro1.jpg',
    //         proName: 'Ulike X',
    //         proPrice: '$299',
    //         proPriceOld: '$429',
    //         proBtn: 'Add to Cart',
    //         proId: 131,
    //         dzTxt: 208
    //       },
    //       {
    //         id: '3',
    //         type: 0,
    //         productType: 1,
    //         cyclicality: 1,
    //         skinTone: 1,
    //         img: './images47/a3.jpg',
    //         starImg: './images47/st.svg',
    //         starTxt: '4.8',
    //         title: 'It’s amazing!',
    //         desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
    //         userImg: './images47/user.png',
    //         userName: 'Kiara B.',
    //         proImg: './images47/pro.png',
    //         proName: 'Air 10',
    //         proPrice: '$299',
    //         proPriceOld: '$429',
    //         proBtn: 'Add to Cart',
    //         proId: 131232,
    //         dzTxt: 208
    //       }
    //     ]

    //     this.init();
    //   }

    //   init() {
    //     let that = this
    //     // 初始设置点赞缓存和随机增加数据
    //     this.setDzData()
    //     // 初始化页面数据
    //     this.filterHtml(false, true);
    //     // 合并监听点击事件
    //     this.el.addEventListener('click', (event) => {
    //       const target = event.target;
    //       // 处理tab切换
    //       const tabItem = target.closest('.results-reviews-tab-item');
    //       if (tabItem) {
    //         const allItems = that.el.querySelectorAll('.results-reviews-tab-item');
    //         allItems.forEach(item => item.classList.remove('active'));
    //         tabItem.classList.add('active');
    //         that.filter.type = parseInt(tabItem.getAttribute('data-type'), 10);
    //         that.filterHtml();
    //         return; // 防止继续执行后面的代码
    //       }

    //       // 处理加入购物车
    //       const addToCartButton = target.closest('.results-reviews-product-btn');
    //       if (addToCartButton) {
    //         const pId = addToCartButton.getAttribute('data-proId');
    //         that.toggleLoading(true);
    //         setTimeout(() => {
    //           that.toggleLoading(false);
    //         }, 3000);
    //         return; // 防止继续执行后面的代码
    //       }

    //       // 处理点赞或取消
    //       const likeButton = target.closest('.results-reviews-dz');
    //       if (likeButton) {
    //         const parentItem = likeButton.closest('.results-reviews-item');
    //         if (!parentItem) return;
    //         const id = parentItem.getAttribute('data-id');
    //         let dzItem = that.setDzData(true, id, true); // 获取点赞数据 和 执行了点赞缓存数据更新(第三个参数为true)
    //         const span = likeButton.querySelector('span');

    //         if (!dzItem.isDz) {
    //           likeButton.classList.remove('active');
    //         } else {
    //           likeButton.classList.add('active');
    //         }

    //         if (span) {
    //           span.textContent = dzItem.num;
    //         }
    //         return; // 防止继续执行后面的代码
    //       }

    //       // 显示/隐藏筛选框
    //       let showFilter = target.closest('.results-reviews-filter-top');
    //       let doneFilter = target.closest('.done-filter-popup');
    //       if (showFilter || doneFilter) {
    //         if (!showFilter && doneFilter) showFilter = doneFilter;
    //         const filterContainer = showFilter.closest('.results-reviews-filter');
    //         filterContainer.classList.toggle('open-filter');
    //         const sibling = showFilter.closest('.results-reviews-filter').querySelector('.results-reviews-filter-tj');
    //         if (sibling) {
    //           sibling.style.display = window.getComputedStyle(sibling).display == 'none' ? 'block' : 'none';
    //           if (this.isMobile()) {
    //             document.body.classList.toggle('filter-fixed');
    //           }
    //         }

    //         return; // 防止继续执行后面的代码
    //       }
    //       // 过滤选项点击
    //       const filtertem = target.closest('.results-reviews-filter-item');
    //       if (filtertem) {
    //         if (event.target.tagName === 'INPUT') {
    //           const inputEl = filtertem.querySelector('input');
    //           const name = inputEl.name;
    //           const value = parseInt(inputEl.value, 10);
    //           const tagTxt = filtertem.getAttribute('data-txt');
    //           if (inputEl.checked) {
    //             that.filter[name].push(value);
    //             that.filterTag.push({ tagTxt, value, name })
    //           } else {
    //             that.filter[name] = that.filter[name].filter(item => item !== value);
    //             that.filterTag = that.filterTag.filter(item => !(item.name === name && item.value === value));
    //           }
    //           that.filterHtml();
    //         }
    //         return; // 防止继续执行后面的代码
    //       }

    //       // 清除所有筛选条件
    //       const clearAll = target.closest('.clear-filter-all');
    //       if (clearAll) {
    //         that.filter = {
    //           type: 0,
    //           productType: [],
    //           cyclicality: [],
    //           skinTone: [],
    //           other: [],
    //           currentPage: 0,
    //           pageSize: 3
    //         };
    //         that.filterTag = [];

    //         clearAll.closest('.results-reviews-filter-tj').querySelectorAll('input[type="checkbox"]').forEach(item => item.checked = false);
    //         const sibling = clearAll.closest('.results-reviews-filter').querySelector('.results-reviews-filter-tj');
    //         if (sibling) {
    //           sibling.style.display = 'none';
    //         }
    //         that.el.querySelector('.results-reviews-filter').classList.remove('open-filter');
    //         that.filterHtml();
    //         return; // 防止继续执行后面的代码
    //       }

    //       // 删除单个筛选条件
    //       const tagClose = target.closest('.tag-close');
    //       if (tagClose) {
    //         const parentTag = target.closest('.results-reviews-tag');
    //         if (parentTag) {
    //           const name = parentTag.getAttribute('data-name');
    //           const value = parseInt(parentTag.getAttribute('data-val'), 10);
    //           target.closest('.results-reviews-filter').querySelector(`input[name="${name}"][value="${value}"]`).checked = false;
    //           that.filterTag = that.filterTag.filter(item => !(item.name === name && item.value === value));
    //           that.filter[name] = that.filter[name].filter(item => item !== value);
    //           that.filterHtml();
    //         }
    //         return; // 防止继续执行后面的代码
    //       }

    //       // 加载更多
    //       const loadMore = target.closest('.results-reviews-more-tap');
    //       if (loadMore) {
    //         that.filter.currentPage += 1;
    //         that.filterHtml(true);
    //       }
    //     });

    //     // 点击任意地方关闭指定弹窗
    //     document.addEventListener('click', (event) => {
    //       const ancestorClass = 'results-reviews-filter';
    //       const targetElement = event.target;
    //       if (!targetElement.closest(`.${ancestorClass}`)) {
    //         this.el.querySelector('.results-reviews-filter-tj').style.display = 'none';
    //         this.el.querySelector('.results-reviews-filter').classList.remove('open-filter');
    //       }
    //     });
    //     // 设置过滤按钮的top值
    //     that.setFilterTop()

    //     window.addEventListener('scroll', () => {
    //       if (!this.isChecking && this.isMobile()) {
    //         this.isChecking = true;
    //         let top = this.checkSticky(this.el.querySelector('.results-reviews-new'));
    //         requestAnimationFrame(() => {
    //           this.isChecking = false;
    //           if (top <= 0) {
    //             this.el.classList.add('fixed-top');
    //           } else {
    //             this.el.classList.remove('fixed-top');
    //           }
    //         });
    //       }
    //     });
    //   }

    //   // 根据过滤后的数据 隐藏其他筛选条件下没有数据的筛选条件
    //   filterHide(list) {
    //     let $productType = this.el.querySelectorAll('[name="productType"]')
    //     let $cyclicality = this.el.querySelectorAll('[name="cyclicality"]')
    //     let $skinTone = this.el.querySelectorAll('[name="skinTone"]')
    //     let $other = this.el.querySelectorAll('[name="other"]')
    //     let productType = [], cyclicality = [], skinTone = [], other = [];
    //     if (list.length === 0) {
    //       this.el.querySelector('.results-reviews-filter').style.display = 'none'
    //       return
    //     } else {
    //       this.el.querySelector('.results-reviews-filter').style.display = 'block'
    //     }
    //     list.forEach(item => {
    //       productType.push(item.productType)
    //       cyclicality.push(item.cyclicality)
    //       skinTone.push(item.skinTone)
    //       other.push(item.other)
    //     })

    //     if ($productType.length) {
    //       $productType.forEach(item => {
    //         if (productType.includes(item.value * 1)) {
    //           item.closest('.results-reviews-filter-item').style.display = 'block'
    //         } else {
    //           item.closest('.results-reviews-filter-item').style.display = 'none'
    //         }
    //       })

    //       if (!productType.length) {
    //         $productType[0].closest('.results-reviews-filter-box').style.display = 'none'
    //       } else {
    //         $productType[0].closest('.results-reviews-filter-box').style.display = 'block'
    //       }
    //     }

    //     if ($cyclicality.length) {
    //       $cyclicality.forEach(item => {
    //         if (cyclicality.includes(item.value * 1)) {
    //           item.closest('.results-reviews-filter-item').style.display = 'block'
    //         } else {
    //           item.closest('.results-reviews-filter-item').style.display = 'none'
    //         }
    //       })
    //       if (!cyclicality.length) {
    //         $cyclicality[0].closest('.results-reviews-filter-box').style.display = 'none'
    //       } else {
    //         $cyclicality[0].closest('.results-reviews-filter-box').style.display = 'block'
    //       }

    //     }

    //     if ($skinTone.length) {
    //       $skinTone.forEach(item => {
    //         if (skinTone.includes(item.value * 1)) {
    //           item.closest('.results-reviews-filter-item').style.display = 'block'
    //         } else {
    //           item.closest('.results-reviews-filter-item').style.display = 'none'
    //         }
    //       })
    //       if (!skinTone.length) {
    //         $skinTone[0].closest('.results-reviews-filter-box').style.display = 'none'
    //       } else {
    //         $skinTone[0].closest('.results-reviews-filter-box').style.display = 'block'
    //       }
    //     }

    //     if ($other.length) {
    //       $other.forEach(item => {
    //         if (other.includes(item.value * 1)) {
    //           item.closest('.results-reviews-filter-item').style.display = 'block'
    //         } else {
    //           item.closest('.results-reviews-filter-item').style.display = 'none'
    //         }
    //       })

    //       if (!other.length) {
    //         $other[0].closest('.results-reviews-filter-box').style.display = 'none'
    //       } else {
    //         $other[0].closest('.results-reviews-filter-box').style.display = 'block'
    //       }
    //     }
    //   }

    //   // 判断元素是否到顶部
    //   checkSticky(element) {
    //     const rect = element.getBoundingClientRect();
    //     return rect.top;
    //   }

    //   // 设置过滤按钮的top值
    //   setFilterTop() {
    //     if (!this.isMobile()) return;
    //     const filterContainer = this.el.querySelector('.results-reviews-filter');
    //     const reviewsTop = this.el.querySelector('.results-reviews-new-top');
    //     const headerHeight = 67;
    //     const top = this.getHeight(reviewsTop) + headerHeight;
    //     filterContainer.style.top = `${top}px`;
    //   }

    //   // 获取指定元素的高度
    //   getHeight(element) {
    //     return element.getBoundingClientRect().height;
    //   }
    //   // 判断是否移动端（小于991）
    //   isMobile() {
    //     return window.innerWidth < 991;
    //   }
    //   // 初始设置点赞数据
    //   setDzData(isGetItem = false, id, isDzTap = false) {
    //     const dzList = localStorage.getItem('dzList') ? JSON.parse(localStorage.getItem('dzList')) : [];
    //     if (isGetItem) {
    //       // 根据id获取点赞数据
    //       const dzIndex = dzList.findIndex(dz => dz.id === id);
    //       if (isDzTap) {
    //         // 执行点赞数据更新
    //         dzList[dzIndex].num = dzList[dzIndex].num > dzList[dzIndex].randomNum ? dzList[dzIndex].num + (dzList[dzIndex].isDz ? -1 : 1) : dzList[dzIndex].randomNum + (dzList[dzIndex].isDz ? -1 : 1);
    //         dzList[dzIndex].isDz = !dzList[dzIndex].isDz
    //         if (!dzList[dzIndex].isDz && dzList[dzIndex].randomNum < dzList[dzIndex].num) {
    //           dzList[dzIndex].randomNum = dzList[dzIndex].num
    //         }
    //         localStorage.setItem('dzList', JSON.stringify(dzList));
    //         return { ...dzList[dzIndex] }
    //       }
    //       if (dzIndex !== -1) {
    //         return { ...dzList[dzIndex] };
    //       } else {
    //         return { oldNum: 0, num: 0, isDz: false };
    //       }
    //     } else {
    //       this.data.forEach(item => {
    //         const dzIndex = dzList.findIndex(dz => dz.id === item.id);
    //         // 有缓存更新缓存点赞数据
    //         if (dzIndex !== -1) {
    //           // 判断初始数据和缓存点赞oldNum是否一致，不一致则更新缓存数据
    //           if (dzList[dzIndex].oldNum !== item.dzTxt) {
    //             dzList[dzIndex] = { id: item.id, num: item.dzTxt || 0, oldNum: item.dzTxt || 0, randomNum: item.dzTxt || 0, isDz: dzList[dzIndex].isDz || false };
    //           } else {
    //             // 点赞数据和缓存点赞oldNum一致，则增加点赞数量
    //             dzList[dzIndex] = { id: item.id, num: this.addDzNum(dzList[dzIndex].num || 0), oldNum: item.dzTxt || 0, randomNum: this.addDzNum(dzList[dzIndex].randomNum || 0), isDz: dzList[dzIndex].isDz || false };
    //           }
    //         } else {
    //           // 没有缓存，则新增点赞数据
    //           dzList.push({ id: item.id, num: item.dzTxt || 0, oldNum: item.dzTxt || 0, randomNum: item.dzTxt || 0, isDz: false });
    //         }
    //       });
    //     }
    //     localStorage.setItem('dzList', JSON.stringify(dzList));
    //   }

    //   // 随机返回范围内的数字
    //   getRandomArbitrary(min, max) {
    //     return Math.floor(Math.random() * (max - min + 1)) + min;
    //   }

    //   // 增加点赞数量
    //   addDzNum(num) {
    //     // 刷新概率百分之20增加点赞数量
    //     return this.getRandomArbitrary(0, 10) > 2 ? num + this.getRandomArbitrary(1, 3) : num;
    //   }

    //   // 定义遮罩方法
    //   toggleLoading(isOpen) {
    //     let overlay = document.getElementById('loading-overlay');
    //     let styleElement = document.getElementById('loading-style');

    //     if (isOpen) {
    //       if (!overlay) {
    //         // 创建遮罩层
    //         overlay = document.createElement('div');
    //         overlay.id = 'loading-overlay';
    //         overlay.style.position = 'fixed';
    //         overlay.style.top = '0';
    //         overlay.style.left = '0';
    //         overlay.style.width = '100%';
    //         overlay.style.height = '100%';
    //         overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.6)';
    //         overlay.style.zIndex = '1000';
    //         overlay.style.display = 'flex';
    //         overlay.style.justifyContent = 'center';
    //         overlay.style.alignItems = 'center';

    //         // 创建转圈动画
    //         const spinner = document.createElement('div');
    //         spinner.style.width = '40px';
    //         spinner.style.height = '40px';
    //         spinner.style.border = '3px solid #aaa';
    //         spinner.style.borderTop = '3px solid #e0004d';
    //         spinner.style.borderRadius = '50%';
    //         spinner.style.animation = 'ulikeSpin 1s linear infinite';

    //         overlay.appendChild(spinner);
    //         document.body.appendChild(overlay);

    //         // 添加 CSS 动画
    //         if (!styleElement) {
    //           styleElement = document.createElement('style');
    //           styleElement.id = 'loading-style';
    //           styleElement.innerHTML = `
    //               body{
    //                 overflow: hidden;
    //               }
    //               @keyframes ulikeSpin {
    //                   0% { transform: rotate(0deg); }
    //                   100% { transform: rotate(360deg); }
    //               }
    //             `;
    //           document.head.appendChild(styleElement);
    //         }
    //       }
    //     } else {
    //       // 移除遮罩层和样式
    //       if (overlay) {
    //         overlay.remove();
    //       }
    //       if (styleElement) {
    //         styleElement.remove();
    //       }
    //     }
    //   }

    //   // 过滤更新html
    //   filterHtml(isPage = false, isInit = false) {
    //     if (!isPage) this.filter.currentPage = 0
    //     this.filterList = this.filterData(this.data, this.filter)
    //     this.filterHide(this.filterList)
    //     let list = isPage ? this.getCurrentPageData(this.filterList) : this.filterList.slice(0, 3)
    //     this.el.querySelector('.results-reviews-more').style.display = 'flex'

    //     if (list.length < this.filter.pageSize || list.length === this.filterList.length) {
    //       this.el.querySelector('.results-reviews-more').style.display = 'none'
    //     }



    //     // 更新缓存点赞数据
    //     this.setDzData()
    //     this.buildHtml(list, isPage)
    //     if (isInit || isPage) return;
    //     this.scrollToTopOfElement(this.el)
    //   }

    //   // 滚动到顶部
    //   scrollToTopOfElement(element) {
    //     if (!element) return;
    //     element.scrollIntoView({
    //       behavior: 'smooth', // 平滑滚动
    //       block: 'start',     // 滚动到目标元素顶部
    //       inline: 'nearest',  // 水平方向的对齐方式
    //     });
    //   }
    //   // 分页添加数据
    //   getCurrentPageData(data = []) {
    //     const start = this.filter.currentPage * this.filter.pageSize;
    //     const end = start + this.filter.pageSize;
    //     if (start >= data.length) return [];
    //     return data.slice(start, end);
    //   }
    //   // 筛选数据
    //   filterData(data, filter) {
    //     return data.filter(item => {
    //       // 根据每个条件进行筛选
    //       return (
    //         (item.type === filter.type) && // 匹配 type
    //         (filter.productType.length === 0 || filter.productType.includes(item.productType)) && // 如果 productType 数组为空，则不过滤，否则匹配 productType
    //         (filter.cyclicality.length === 0 || filter.cyclicality.includes(item.cyclicality)) && // 如果 cyclicality 数组为空，则不过滤，否则匹配 cyclicality
    //         (filter.skinTone.length === 0 || filter.skinTone.includes(item.skinTone)) && // 如果 skinTone 数组为空，则不过滤，否则匹配 skinTone
    //         (filter.other.length === 0 || filter.other.includes(item.other)) // 如果 other 数组为空，则不过滤，否则匹配 other
    //       );
    //     });
    //   }

    //   // 更新html
    //   buildHtml(list = [], isPage = false) {
    //     let tagHtml = '';
    //     let html = '';
    //     list.forEach((item, index) => {
    //       let dzItem = this.setDzData(true, item.id)
    //       html += `
    //       <div class="results-reviews-item" data-id="${item.id}">
    //         <div class="results-reviews-item-img">
    //           <div class="results-reviews-item-img-cont">
    //             <img src="${item.img}" class="img" alt="">
    //             ${item.beforTxt ? `<div class="results-reviews-label before-tag">${item.beforTxt}</div>` : ''}
    //             ${item.afterTxt ? `<div class="results-reviews-label after-tag">${item.afterTxt}</div>` : ''}
    //           </div>
    //         </div>
    //         <div class="results-reviews-item-text">
    //           <div class="results-reviews-start">
    //             <img src="${item.starImg}" alt="" class="start-img">
    //             ${item.starTxt}
    //           </div>
    //           <div class="results-reviews-h4">${item.title}</div>
    //           <div class="results-reviews-desc">${item.desc}</div>
    //           <div class="results-reviews-user">
    //             <img src="${item.userImg}" alt="" class="user-img">
    //             ${item.userName}
    //           </div>
    //           <div class="results-reviews-product">
    //             <img src="${item.proImg}" alt="" class="pro-img">
    //             <div class="results-reviews-product-txt">
    //               <div class="results-reviews-product-name">${item.proName}</div>
    //               <div class="results-reviews-product-price">
    //                 <span class="n-price">${item.proPrice}</span>
    //                 <span class="d-price">${item.proPriceOld}</span>
    //               </div>
    //               <div class="results-reviews-product-btn" data-proId = "${item.proId}">
    //                 ${item.proBtn}
    //                 <svg xmlns="http://www.w3.org/2000/svg" width="15" height="12" viewBox="0 0 15 12" fill="none">
    //                   <path d="M0.950195 5.8656L14.0372 5.86499" stroke="#190A0A" stroke-width="0.608696" />
    //                   <path d="M11.2979 3.12585L14.5032 5.86559L11.2979 8.53594" stroke="#190A0A"
    //                     stroke-width="0.608696" stroke-linejoin="round" />
    //                 </svg>
    //               </div>
    //             </div>
    //           </div>
    //           <div class="results-reviews-dz ${dzItem.isDz ? 'active' : ''}">
    //             <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 41 41" fill="none">
    //               <circle cx="20.9502" cy="20.865" r="19.5853" stroke="#EBEBEB" stroke-width="0.829368" />
    //               <path
    //                 d="M17.0147 20.0521L20.2663 12.736C20.9131 12.736 21.5334 12.993 21.9907 13.4503C22.448 13.9076 22.705 14.5279 22.705 15.1747V18.4263H27.306C27.5417 18.4236 27.7751 18.4722 27.9901 18.5687C28.2051 18.6653 28.3966 18.8073 28.5512 18.9852C28.7059 19.163 28.82 19.3724 28.8857 19.5987C28.9514 19.8251 28.9672 20.063 28.9318 20.296L27.81 27.6121C27.7512 27.9997 27.5543 28.3531 27.2555 28.6071C26.9567 28.861 26.5763 28.9984 26.1842 28.994H17.0147M17.0147 20.0521V28.994M17.0147 20.0521H14.576C14.1448 20.0521 13.7313 20.2234 13.4264 20.5283C13.1215 20.8332 12.9502 21.2467 12.9502 21.6779V27.3682C12.9502 27.7994 13.1215 28.2129 13.4264 28.5178C13.7313 28.8227 14.1448 28.994 14.576 28.994H17.0147"
    //                 stroke="#190A0A" stroke-width="0.812899" stroke-linecap="round" stroke-linejoin="round" />
    //             </svg>
    //             <span>
    //               ${dzItem.isDz ? dzItem.num : (dzItem.randomNum || item.dzTxt || 0)}
    //             </span>
    //           </div>
    //         </div>
    //       </div>`
    //     })

    //     this.filterTag.forEach((item, index) => {
    //       tagHtml += `
    //         <div class="results-reviews-tag" data-name="${item.name}" data-val="${item.value}">
    //           ${item.tagTxt}
    //           <span class="tag-close">
    //             <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" fill="none">
    //               <path d="M10.8906 4.16956L3.89062 11.1696" stroke="#E0004D" stroke-width="0.753846" stroke-linecap="round" stroke-linejoin="round"/>
    //               <path d="M3.89062 4.16956L10.8906 11.1696" stroke="#E0004D" stroke-width="0.753846" stroke-linecap="round" stroke-linejoin="round"/>
    //             </svg>
    //           </span>
    //         </div>
    //       `
    //     })
    //     if (this.filterTag.length) {
    //       this.el.querySelector('.results-reviews-tags').innerHTML = tagHtml
    //       this.el.querySelector('.results-reviews-tags').style.display = 'flex'
    //     } else {
    //       this.el.querySelector('.results-reviews-tags').style.display = 'none'
    //     }

    //     if (isPage) {
    //       this.el.querySelector('.results-reviews-list').innerHTML += html;
    //     } else {
    //       this.el.querySelector('.results-reviews-list').innerHTML = html;
    //     }
    //   }
    // }

    class resultsReviews extends HTMLElement {
      constructor(el) {
        super()
        this.el = this
        this.isChecking = false
        this.filter = {
          type: 0,
          productType: [],
          cyclicality: [],
          skinTone: [],
          other: [],
          currentPage: 0,
          pageSize: 3,
        }
        this.filterTag = []
        this.filterList = []
        this.data = [
          {
            id: '0',
            type: 0,
            productType: 0,
            cyclicality: 0,
            skinTone: 0,
            other: 0,
            img: './images47/a1.jpg',
            beforTxt: 'Before',
            afterTxt: 'After 1-4',
            video: '',
            starImg: './images47/st.svg',
            starTxt: '4.8',
            title: 'It’s amazing!',
            desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
            userImg: './images47/user.png',
            userName: 'Kiara B.',
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 132132,
            dzTxt: 208,
          },
          {
            id: '1',
            type: 0,
            productType: 0,
            cyclicality: 0,
            skinTone: 0,
            img: './images47/a2.jpg',
            starImg: './images47/st.svg',
            starTxt: '4.8',
            title: 'It’s amazing!',
            desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
            userImg: './images47/user.png',
            userName: 'Kiara B.',
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 1321,
            dzTxt: 208,
          },
          {
            id: '2',
            type: 0,
            productType: 2,
            cyclicality: 0,
            skinTone: 0,
            img: './images47/a3.jpg',
            starImg: './images47/st.svg',
            starTxt: '4.8',
            title: 'It’s amazing!',
            desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
            userImg: './images47/user.png',
            userName: 'Kiara B.',
            proImg: './images47/pro1.jpg',
            proName: 'Ulike X',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 131,
            dzTxt: 208,
          },
          {
            id: '3',
            type: 0,
            productType: 1,
            cyclicality: 1,
            skinTone: 1,
            img: './images47/a3.jpg',
            starImg: './images47/st.svg',
            starTxt: '4.8',
            title: 'It’s amazing!',
            desc: 'It’s amazing, I was able to recover my hair with this powerful product. I don’t have extensions, and it feels so natural.',
            userImg: './images47/user.png',
            userName: 'Kiara B.',
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 131232,
            dzTxt: 208,
          },
        ]

        this.init()
      }

      init() {
        let that = this
        // 初始设置点赞缓存和随机增加数据
        this.setDzData()
        // 初始化页面数据
        this.filterHtml(false, true)
        // 合并监听点击事件
        this.el.addEventListener('click', (event) => {
          const target = event.target
          // 处理tab切换
          const tabItem = target.closest('.results-reviews-tab-item')
          if (tabItem) {
            const allItems = that.el.querySelectorAll('.results-reviews-tab-item')
            allItems.forEach((item) => item.classList.remove('active'))
            tabItem.classList.add('active')
            that.filter.type = parseInt(tabItem.getAttribute('data-type'), 10)
            that.filterHtml()
            return // 防止继续执行后面的代码
          }

          // 处理加入购物车
          const addToCartButton = target.closest('.results-reviews-product-btn')
          if (addToCartButton) {
            const pId = addToCartButton.getAttribute('data-proId')
            that.toggleLoading(true)
            setTimeout(() => {
              that.toggleLoading(false)
            }, 3000)
            return // 防止继续执行后面的代码
          }

          // 处理点赞或取消
          const likeButton = target.closest('.results-reviews-dz')
          if (likeButton) {
            const parentItem = likeButton.closest('.results-reviews-item')
            if (!parentItem) return
            const id = parentItem.getAttribute('data-id')
            let dzItem = that.setDzData(true, id, true) // 获取点赞数据 和 执行了点赞缓存数据更新(第三个参数为true)
            const span = likeButton.querySelector('span')

            if (!dzItem.isDz) {
              likeButton.classList.remove('active')
            } else {
              likeButton.classList.add('active')
            }

            if (span) {
              span.textContent = dzItem.num
            }
            return // 防止继续执行后面的代码
          }

          // 显示/隐藏筛选框
          let showFilter = target.closest('.results-reviews-filter-top')
          let doneFilter = target.closest('.done-filter-popup')
          if (showFilter || doneFilter) {
            if (!showFilter && doneFilter) showFilter = doneFilter
            const filterContainer = showFilter.closest('.results-reviews-filter')
            filterContainer.classList.toggle('open-filter')
            const sibling = showFilter
              .closest('.results-reviews-filter')
              .querySelector('.results-reviews-filter-tj')
            if (sibling) {
              sibling.style.display =
                window.getComputedStyle(sibling).display == 'none'
                  ? 'block'
                  : 'none'
              if (this.isMobile()) {
                document.body.classList.toggle('filter-fixed')
              }
            }

            return // 防止继续执行后面的代码
          }
          // 过滤选项点击
          const filtertem = target.closest('.results-reviews-filter-item')
          if (filtertem) {
            if (event.target.tagName === 'INPUT') {
              const inputEl = filtertem.querySelector('input')
              const name = inputEl.name
              const value = parseInt(inputEl.value, 10)
              const tagTxt = filtertem.getAttribute('data-txt')
              if (inputEl.checked) {
                that.filter[name].push(value)
                that.filterTag.push({ tagTxt, value, name })
              } else {
                that.filter[name] = that.filter[name].filter(
                  (item) => item !== value
                )
                that.filterTag = that.filterTag.filter(
                  (item) => !(item.name === name && item.value === value)
                )
              }
              that.filterHtml()
            }
            return // 防止继续执行后面的代码
          }

          // 清除所有筛选条件
          const clearAll = target.closest('.clear-filter-all')
          if (clearAll) {
            that.filter = {
              type: 0,
              productType: [],
              cyclicality: [],
              skinTone: [],
              other: [],
              currentPage: 0,
              pageSize: 3,
            }
            that.filterTag = []

            clearAll
              .closest('.results-reviews-filter-tj')
              .querySelectorAll('input[type="checkbox"]')
              .forEach((item) => (item.checked = false))
            const sibling = clearAll
              .closest('.results-reviews-filter')
              .querySelector('.results-reviews-filter-tj')
            if (sibling) {
              sibling.style.display = 'none'
            }
            that.el
              .querySelector('.results-reviews-filter')
              .classList.remove('open-filter')
            that.filterHtml()
            return // 防止继续执行后面的代码
          }

          // 删除单个筛选条件
          const tagClose = target.closest('.tag-close')
          if (tagClose) {
            const parentTag = target.closest('.results-reviews-tag')
            if (parentTag) {
              const name = parentTag.getAttribute('data-name')
              const value = parseInt(parentTag.getAttribute('data-val'), 10)
              target
                .closest('.results-reviews-filter')
                .querySelector(
                  `input[name="${name}"][value="${value}"]`
                ).checked = false
              that.filterTag = that.filterTag.filter(
                (item) => !(item.name === name && item.value === value)
              )
              that.filter[name] = that.filter[name].filter((item) => item !== value)
              that.filterHtml()
            }
            return // 防止继续执行后面的代码
          }

          // 加载更多
          const loadMore = target.closest('.results-reviews-more-tap')
          if (loadMore) {
            that.filter.currentPage += 1
            that.filterHtml(true)
          }
        })

        // 点击任意地方关闭指定弹窗
        document.addEventListener('click', (event) => {
          const ancestorClass = 'results-reviews-filter'
          const targetElement = event.target
          if (!targetElement.closest(`.${ancestorClass}`)) {
            this.el.querySelector('.results-reviews-filter-tj').style.display =
              'none'
            this.el
              .querySelector('.results-reviews-filter')
              .classList.remove('open-filter')
          }
        })
        // 设置过滤按钮的top值
        that.setFilterTop()

        window.addEventListener('scroll', () => {
          if (!this.isChecking && this.isMobile()) {
            this.isChecking = true
            let top = this.checkSticky(
              this.el.querySelector('.results-reviews-new')
            )
            requestAnimationFrame(() => {
              this.isChecking = false
              if (top <= 0) {
                this.el.classList.add('fixed-top')
              } else {
                this.el.classList.remove('fixed-top')
              }
            })
          }
        })
      }

      // 根据过滤后的数据 隐藏其他筛选条件下没有数据的筛选条件
      filterHide(list) {
        const filterElements = {
          productType: this.el.querySelectorAll('[name="productType"]'),
          cyclicality: this.el.querySelectorAll('[name="cyclicality"]'),
          skinTone: this.el.querySelectorAll('[name="skinTone"]'),
          other: this.el.querySelectorAll('[name="other"]'),
        }

        const filterData = {
          productType: [],
          cyclicality: [],
          skinTone: [],
          other: [],
        }

        if (list.length === 0) {
          this.el.querySelector('.results-reviews-filter').style.display = 'none'
          return
        } else {
          this.el.querySelector('.results-reviews-filter').style.display = 'block'
        }

        list.forEach((item) => {
          filterData.productType.push(item.productType)
          filterData.cyclicality.push(item.cyclicality)
          filterData.skinTone.push(item.skinTone)
          filterData.other.push(item.other)
        })

        Object.keys(filterElements).forEach((key) => {
          const elements = filterElements[key]
          if (elements.length) {
            elements.forEach((item) => {
              const isVisible = filterData[key].includes(Number(item.value))
              item.closest('.results-reviews-filter-item').style.display = isVisible
                ? 'block'
                : 'none'
            })
            const box = elements[0].closest('.results-reviews-filter-box')
            box.style.display = filterData[key].length ? 'block' : 'none'
          }
        })
      }

      // 判断元素是否到顶部
      checkSticky(element) {
        const rect = element.getBoundingClientRect()
        return rect.top
      }

      // 设置过滤按钮的top值
      setFilterTop() {
        if (!this.isMobile()) return
        const filterContainer = this.el.querySelector('.results-reviews-filter')
        const reviewsTop = this.el.querySelector('.results-reviews-new-top')
        const headerHeight = 67
        const top = this.getHeight(reviewsTop) + headerHeight
        filterContainer.style.top = `${top}px`
      }

      // 获取指定元素的高度
      getHeight(element) {
        return element.getBoundingClientRect().height
      }
      // 判断是否移动端（小于991）
      isMobile() {
        return window.innerWidth < 991
      }
      // 初始设置点赞数据
      setDzData(isGetItem = false, id, isDzTap = false) {
        const dzList = localStorage.getItem('dzList')
          ? JSON.parse(localStorage.getItem('dzList'))
          : []
        if (isGetItem) {
          // 根据id获取点赞数据
          const dzIndex = dzList.findIndex((dz) => dz.id === id)
          if (isDzTap) {
            // 执行点赞数据更新
            dzList[dzIndex].num =
              dzList[dzIndex].num > dzList[dzIndex].randomNum
                ? dzList[dzIndex].num + (dzList[dzIndex].isDz ? -1 : 1)
                : dzList[dzIndex].randomNum + (dzList[dzIndex].isDz ? -1 : 1)
            dzList[dzIndex].isDz = !dzList[dzIndex].isDz
            if (
              !dzList[dzIndex].isDz &&
              dzList[dzIndex].randomNum < dzList[dzIndex].num
            ) {
              dzList[dzIndex].randomNum = dzList[dzIndex].num
            }
            localStorage.setItem('dzList', JSON.stringify(dzList))
            return { ...dzList[dzIndex] }
          }
          if (dzIndex !== -1) {
            return { ...dzList[dzIndex] }
          } else {
            return { oldNum: 0, num: 0, isDz: false }
          }
        } else {
          this.data.forEach((item) => {
            const dzIndex = dzList.findIndex((dz) => dz.id === item.id)
            // 有缓存更新缓存点赞数据
            if (dzIndex !== -1) {
              // 判断初始数据和缓存点赞oldNum是否一致，不一致则更新缓存数据
              if (dzList[dzIndex].oldNum !== item.dzTxt) {
                dzList[dzIndex] = {
                  id: item.id,
                  num: item.dzTxt || 0,
                  oldNum: item.dzTxt || 0,
                  randomNum: item.dzTxt || 0,
                  isDz: dzList[dzIndex].isDz || false,
                }
              } else {
                // 点赞数据和缓存点赞oldNum一致，则增加点赞数量
                dzList[dzIndex] = {
                  id: item.id,
                  num: this.addDzNum(dzList[dzIndex].num || 0),
                  oldNum: item.dzTxt || 0,
                  randomNum: this.addDzNum(dzList[dzIndex].randomNum || 0),
                  isDz: dzList[dzIndex].isDz || false,
                }
              }
            } else {
              // 没有缓存，则新增点赞数据
              dzList.push({
                id: item.id,
                num: item.dzTxt || 0,
                oldNum: item.dzTxt || 0,
                randomNum: item.dzTxt || 0,
                isDz: false,
              })
            }
          })
        }
        localStorage.setItem('dzList', JSON.stringify(dzList))
      }

      // 随机返回范围内的数字
      getRandomArbitrary(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min
      }

      // 增加点赞数量
      addDzNum(num) {
        // 刷新概率百分之20增加点赞数量
        return this.getRandomArbitrary(0, 10) > 2
          ? num + this.getRandomArbitrary(1, 3)
          : num
      }

      // 定义遮罩方法
      toggleLoading(isOpen) {
        let overlay = document.getElementById('loading-overlay')
        let styleElement = document.getElementById('loading-style')

        if (isOpen) {
          if (!overlay) {
            // 创建遮罩层
            overlay = document.createElement('div')
            overlay.id = 'loading-overlay'
            overlay.style.position = 'fixed'
            overlay.style.top = '0'
            overlay.style.left = '0'
            overlay.style.width = '100%'
            overlay.style.height = '100%'
            overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.6)'
            overlay.style.zIndex = '1000'
            overlay.style.display = 'flex'
            overlay.style.justifyContent = 'center'
            overlay.style.alignItems = 'center'

            // 创建转圈动画
            const spinner = document.createElement('div')
            spinner.style.width = '40px'
            spinner.style.height = '40px'
            spinner.style.border = '3px solid #aaa'
            spinner.style.borderTop = '3px solid #e0004d'
            spinner.style.borderRadius = '50%'
            spinner.style.animation = 'ulikeSpin 1s linear infinite'

            overlay.appendChild(spinner)
            document.body.appendChild(overlay)

            // 添加 CSS 动画
            if (!styleElement) {
              styleElement = document.createElement('style')
              styleElement.id = 'loading-style'
              styleElement.innerHTML = `
              body{
                overflow: hidden;
              }
              @keyframes ulikeSpin {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(360deg); }
              }
            `
              document.head.appendChild(styleElement)
            }
          }
        } else {
          // 移除遮罩层和样式
          if (overlay) {
            overlay.remove()
          }
          if (styleElement) {
            styleElement.remove()
          }
        }
      }

      // 过滤更新html
      filterHtml(isPage = false, isInit = false) {
        if (!isPage) this.filter.currentPage = 0
        this.filterList = this.filterData(this.data, this.filter)
        this.filterHide(this.filterList)
        let list = isPage
          ? this.getCurrentPageData(this.filterList)
          : this.filterList.slice(0, 3)
        this.el.querySelector('.results-reviews-more').style.display = 'flex'

        if (
          list.length < this.filter.pageSize ||
          list.length === this.filterList.length
        ) {
          this.el.querySelector('.results-reviews-more').style.display = 'none'
        }

        // 更新缓存点赞数据
        this.setDzData()
        this.buildHtml(list, isPage)
        if (isInit || isPage) return
        this.scrollToTopOfElement(this.el)
      }

      // 滚动到顶部
      scrollToTopOfElement(element) {
        if (!element) return
        element.scrollIntoView({
          behavior: 'smooth', // 平滑滚动
          block: 'start', // 滚动到目标元素顶部
          inline: 'nearest', // 水平方向的对齐方式
        })
      }
      // 分页添加数据
      getCurrentPageData(data = []) {
        const start = this.filter.currentPage * this.filter.pageSize
        const end = start + this.filter.pageSize
        if (start >= data.length) return []
        return data.slice(start, end)
      }
      // 筛选数据
      filterData(data, filter) {
        return data.filter((item) => {
          // 根据每个条件进行筛选
          return (
            item.type === filter.type && // 匹配 type
            (filter.productType.length === 0 ||
              filter.productType.includes(item.productType)) && // 如果 productType 数组为空，则不过滤，否则匹配 productType
            (filter.cyclicality.length === 0 ||
              filter.cyclicality.includes(item.cyclicality)) && // 如果 cyclicality 数组为空，则不过滤，否则匹配 cyclicality
            (filter.skinTone.length === 0 ||
              filter.skinTone.includes(item.skinTone)) && // 如果 skinTone 数组为空，则不过滤，否则匹配 skinTone
            (filter.other.length === 0 || filter.other.includes(item.other)) // 如果 other 数组为空，则不过滤，否则匹配 other
          )
        })
      }

      // 更新html
      buildHtml(list = [], isPage = false) {
        const tagHtml = this.filterTag
          .map(
            (item) => `
        <div class="results-reviews-tag" data-name="${item.name}" data-val="${item.value}">
            ${item.tagTxt}
            <span class="tag-close">
                <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" fill="none">
                    <path d="M10.8906 4.16956L3.89062 11.1696" stroke="#E0004D" stroke-width="0.753846" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M3.89062 4.16956L10.8906 11.1696" stroke="#E0004D" stroke-width="0.753846" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </span>
        </div>
    `
          )
          .join('')

        const html = list
          .map((item) => {
            const dzItem = this.setDzData(true, item.id)
            return `
      <div class="results-reviews-item" data-id="${item.id}">
        <div class="results-reviews-item-img">
          <div class="results-reviews-item-img-cont">
            <img src="${item.img}" class="img" alt="">
            ${item.beforTxt
                ? `<div class="results-reviews-label before-tag">${item.beforTxt}</div>`
                : ''
              }
            ${item.afterTxt
                ? `<div class="results-reviews-label after-tag">${item.afterTxt}</div>`
                : ''
              }
          </div>
        </div>
        <div class="results-reviews-item-text">
          <div class="results-reviews-start">
            <img src="${item.starImg}" alt="" class="start-img">
            ${item.starTxt}
          </div>
          <div class="results-reviews-h4">${item.title}</div>
          <div class="results-reviews-desc">${item.desc}</div>
          <div class="results-reviews-user">
            <img src="${item.userImg}" alt="" class="user-img">
            ${item.userName}
          </div>
          <div class="results-reviews-product">
            <img src="${item.proImg}" alt="" class="pro-img">
            <div class="results-reviews-product-txt">
              <div class="results-reviews-product-name">${item.proName}</div>
              <div class="results-reviews-product-price">
                <span class="n-price">${item.proPrice}</span>
                <span class="d-price">${item.proPriceOld}</span>
              </div>
              <div class="results-reviews-product-btn" data-proId="${item.proId
              }">
                ${item.proBtn}
                <svg xmlns="http://www.w3.org/2000/svg" width="15" height="12" viewBox="0 0 15 12" fill="none">
                  <path d="M0.950195 5.8656L14.0372 5.86499" stroke="#190A0A" stroke-width="0.608696" />
                  <path d="M11.2979 3.12585L14.5032 5.86559L11.2979 8.53594" stroke="#190A0A" stroke-width="0.608696" stroke-linejoin="round" />
                </svg>
              </div>
            </div>
          </div>
          <div class="results-reviews-dz ${dzItem.isDz ? 'active' : ''}">
            <span>${dzItem.isDz ? dzItem.num : dzItem.randomNum || item.dzTxt || 0
              }</span>
          </div>
        </div>
      </div>`
          })
          .join('')

        const tagsContainer = this.el.querySelector('.results-reviews-tags')
        tagsContainer.innerHTML = tagHtml
        tagsContainer.style.display = this.filterTag.length ? 'flex' : 'none'

        const listContainer = this.el.querySelector('.results-reviews-list')
        listContainer.innerHTML = isPage ? listContainer.innerHTML + html : html
      }
    }

    customElements.define('results-reviews-new', resultsReviews);
  </script>
  <results-reviews-video>
    <div class="results-reviews-video">
      <div class="container">
        <div class="results-reviews-video-top">
          <h3 class="results-reviews-video-title">Watch & shop</h3>
          <div class="results-reviews-video-tabs">
            <div class="results-reviews-video-tab active" data-type="0">Influencer Videos</div>
            <div class="results-reviews-video-tab" data-type="1">UGC Videos</div>
          </div>
        </div>
        <div class="results-reviews-video-cont">
          <div class="results-reviews-video-list swiper-wrapper">
          </div>
          <div class="results-reviews-video-arraws">
            <div class="results-reviews-video-arraw video-swiper-prev">
              <svg xmlns="http://www.w3.org/2000/svg" width="57" height="57" viewBox="0 0 57 57" fill="none">
                <circle cx="28" cy="28" r="28" transform="matrix(1 -8.74228e-08 -8.74228e-08 -1 0.28125 56.4575)"
                  fill="#FBFAF4" />
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M23.2409 46.7505L22.5338 47.4576L21.1195 46.0434L21.8267 45.3363L28.2824 38.8806L34.3676 32.7954C35.1486 32.0143 36.415 32.0143 37.196 32.7954L29.6966 40.2948L23.2409 46.7505ZM40.7408 27.8363C41.1314 28.2268 41.1314 28.86 40.7408 29.2505C40.6094 29.382 40.4503 29.4693 40.2824 29.5122L40.2824 29.5434L40.0359 29.5434L40.0316 29.5434L39.2824 29.5434L29.0318 29.5434L18.7812 29.5434L16.2812 29.5434C15.1766 29.5434 14.2812 28.648 14.2812 27.5434L18.7812 27.5434L37.6195 27.5434L21.8266 11.7505L21.1195 11.0434L22.5338 9.62922L23.2409 10.3363L40.7408 27.8363Z"
                  fill="#190A0A" />
              </svg>
            </div>
            <div class="results-reviews-video-arraw video-swiper-next">
              <svg xmlns="http://www.w3.org/2000/svg" width="57" height="57" viewBox="0 0 57 57" fill="none">
                <circle cx="28" cy="28" r="28" transform="matrix(1 -8.74228e-08 -8.74228e-08 -1 0.28125 56.4575)"
                  fill="#FBFAF4" />
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M23.2409 46.7505L22.5338 47.4576L21.1195 46.0434L21.8267 45.3363L28.2824 38.8806L34.3676 32.7954C35.1486 32.0143 36.415 32.0143 37.196 32.7954L29.6966 40.2948L23.2409 46.7505ZM40.7408 27.8363C41.1314 28.2268 41.1314 28.86 40.7408 29.2505C40.6094 29.382 40.4503 29.4693 40.2824 29.5122L40.2824 29.5434L40.0359 29.5434L40.0316 29.5434L39.2824 29.5434L29.0318 29.5434L18.7812 29.5434L16.2812 29.5434C15.1766 29.5434 14.2812 28.648 14.2812 27.5434L18.7812 27.5434L37.6195 27.5434L21.8266 11.7505L21.1195 11.0434L22.5338 9.62922L23.2409 10.3363L40.7408 27.8363Z"
                  fill="#190A0A" />
              </svg>
            </div>
          </div>
        </div>
      </div>
      <div class="results-reviews-video-share-popup">
        <div class="results-reviews-video-share-cont">
          <div class="results-reviews-video-share-top">
            <div class="results-reviews-video-share-t">Share</div>
            <div class="results-reviews-video-share-close">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25" fill="none">
                <path d="M19.7992 4.69995L4.19922 20.3" stroke="#756B6E" stroke-width="1.68" stroke-linecap="round"
                  stroke-linejoin="round" />
                <path d="M4.19922 4.69995L19.7992 20.3" stroke="#756B6E" stroke-width="1.68" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </div>
          </div>
          <div class="results-reviews-video-share-list">
            <div class="results-reviews-video-share-item">
              <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60" fill="none">
                <g clip-path="url(#clip0_345_66070)">
                  <path
                    d="M29.5655 60C45.8434 60 59.0392 46.5686 59.0392 30C59.0392 13.4314 45.8434 0 29.5655 0C13.2876 0 0.0917969 13.4314 0.0917969 30C0.0917969 46.5686 13.2876 60 29.5655 60Z"
                    fill="#357EF2" />
                  <path
                    d="M43.8027 26.4824C44.0247 26.3159 44.3578 26.4824 44.3578 26.76V38.0853C44.3578 39.5842 43.1365 40.7501 41.6931 40.7501H18.5984C17.0994 40.7501 15.9336 39.5842 15.9336 38.0853V26.76C15.9336 26.4824 16.2112 26.3159 16.4332 26.4824C17.7101 27.4817 19.3201 28.7031 24.9827 32.8113C26.1486 33.644 28.1471 35.476 30.1457 35.476C32.0888 35.476 34.1429 33.644 35.2532 32.8113C40.9158 28.7031 42.5258 27.4817 43.8027 26.4824ZM30.1457 33.644C28.8133 33.6995 26.9813 32.034 26.0375 31.3678C18.6539 26.0383 18.0987 25.5387 16.4332 24.2063C16.1001 23.9842 15.9336 23.5956 15.9336 23.1515V22.0967C15.9336 20.6532 17.0994 19.4319 18.5984 19.4319H41.6931C43.1365 19.4319 44.3578 20.6532 44.3578 22.0967V23.1515C44.3578 23.5956 44.1358 23.9842 43.8027 24.2063C42.1372 25.5387 41.582 26.0383 34.1984 31.3678C33.2546 32.034 31.4226 33.6995 30.1457 33.644Z"
                    fill="white" />
                </g>
                <defs>
                  <clipPath id="clip0_345_66070">
                    <rect width="60" height="60" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              Inbox
            </div>
            <div class="results-reviews-video-share-item">
              <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60" fill="none">
                <g clip-path="url(#clip0_345_66070)">
                  <path
                    d="M29.5655 60C45.8434 60 59.0392 46.5686 59.0392 30C59.0392 13.4314 45.8434 0 29.5655 0C13.2876 0 0.0917969 13.4314 0.0917969 30C0.0917969 46.5686 13.2876 60 29.5655 60Z"
                    fill="#357EF2" />
                  <path
                    d="M43.8027 26.4824C44.0247 26.3159 44.3578 26.4824 44.3578 26.76V38.0853C44.3578 39.5842 43.1365 40.7501 41.6931 40.7501H18.5984C17.0994 40.7501 15.9336 39.5842 15.9336 38.0853V26.76C15.9336 26.4824 16.2112 26.3159 16.4332 26.4824C17.7101 27.4817 19.3201 28.7031 24.9827 32.8113C26.1486 33.644 28.1471 35.476 30.1457 35.476C32.0888 35.476 34.1429 33.644 35.2532 32.8113C40.9158 28.7031 42.5258 27.4817 43.8027 26.4824ZM30.1457 33.644C28.8133 33.6995 26.9813 32.034 26.0375 31.3678C18.6539 26.0383 18.0987 25.5387 16.4332 24.2063C16.1001 23.9842 15.9336 23.5956 15.9336 23.1515V22.0967C15.9336 20.6532 17.0994 19.4319 18.5984 19.4319H41.6931C43.1365 19.4319 44.3578 20.6532 44.3578 22.0967V23.1515C44.3578 23.5956 44.1358 23.9842 43.8027 24.2063C42.1372 25.5387 41.582 26.0383 34.1984 31.3678C33.2546 32.034 31.4226 33.6995 30.1457 33.644Z"
                    fill="white" />
                </g>
                <defs>
                  <clipPath id="clip0_345_66070">
                    <rect width="60" height="60" fill="white" />
                  </clipPath>
                </defs>
              </svg>
              Inbox
            </div>
          </div>
          <div class="results-reviews-video-copy">
            <div class="results-reviews-video-copy-txt" title="https://www.ulike.com/pages/result-review">
              https://www.ulike.com/pages/result-review
            </div>
            <div class="results-reviews-video-copy-btn">Copy</div>
          </div>
        </div>
      </div>
      <div class="results-reviews-video-popup">
        <div class="results-popu-top">
          <div class="results-popu-close">
            <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 41 41" fill="none">
              <path d="M33.1797 7.55164L7.17969 33.5516" stroke="white" stroke-width="2.8" stroke-linecap="round"
                stroke-linejoin="round" />
              <path d="M7.17969 7.55164L33.1797 33.5516" stroke="white" stroke-width="2.8" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
          <div class="results-popu-zoom">
            <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 41 41" fill="none">
              <path
                d="M35.1803 5.55164C35.6224 5.55164 36.0463 5.72723 36.3588 6.03979C36.6714 6.35235 36.847 6.77628 36.847 7.2183V18.885H33.5137V8.88497H6.84701V32.2183H16.847V35.5516H5.18034C4.73831 35.5516 4.31439 35.376 4.00183 35.0635C3.68927 34.7509 3.51367 34.327 3.51367 33.885V7.2183C3.51367 6.77628 3.68927 6.35235 4.00183 6.03979C4.31439 5.72723 4.73831 5.55164 5.18034 5.55164H35.1803ZM35.1803 22.2183C35.6224 22.2183 36.0463 22.3939 36.3588 22.7065C36.6714 23.019 36.847 23.4429 36.847 23.885V33.885C36.847 34.327 36.6714 34.7509 36.3588 35.0635C36.0463 35.376 35.6224 35.5516 35.1803 35.5516H21.847C21.6281 35.5516 21.4114 35.5085 21.2092 35.4248C21.007 35.341 20.8233 35.2182 20.6685 35.0635C20.5137 34.9087 20.391 34.725 20.3072 34.5228C20.2234 34.3206 20.1803 34.1038 20.1803 33.885V23.885C20.1803 23.4429 20.3559 23.019 20.6685 22.7065C20.9811 22.3939 21.405 22.2183 21.847 22.2183H35.1803ZM33.5137 25.5516H23.5137V32.2183H33.5137V25.5516ZM11.3587 11.04L15.1087 14.79L18.5137 11.385V20.5516H9.34701L12.752 17.1466L9.00201 13.3966L11.3587 11.04Z"
                fill="white" />
            </svg>
          </div>
        </div>
        <div class="results-popu-cont">
          <div class="results-popu-swiper swiper-wrapper">
          </div>
        </div>
        <div class="results-popu-arraws">
          <div class="results-popu-arraw video-swiper-prev-popup">
            <svg xmlns="http://www.w3.org/2000/svg" width="57" height="57" viewBox="0 0 57 57" fill="none">
              <circle cx="28.8169" cy="28.7557" r="28" transform="rotate(-180 28.8169 28.7557)" fill="#190A0A"
                fill-opacity="0.6" />
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M33.8573 47.0486L34.5644 47.7557L35.9786 46.3415L35.2715 45.6344L28.8158 39.1787L22.7306 33.0935C21.9495 32.3124 20.6832 32.3124 19.9021 33.0935L27.4016 40.5929L33.8573 47.0486ZM16.3573 28.1344C15.9668 28.5249 15.9668 29.1581 16.3573 29.5486C16.4888 29.6801 16.6478 29.7673 16.8158 29.8103L16.8158 29.8415L17.0622 29.8415L17.0666 29.8415L17.8158 29.8415L28.0663 29.8415L38.3169 29.8415L40.817 29.8415C41.9215 29.8415 42.817 28.9461 42.817 27.8415L38.3169 27.8415L19.4786 27.8415L35.2715 12.0486L35.9786 11.3415L34.5644 9.92731L33.8573 10.6344L16.3573 28.1344Z"
                fill="white" />
            </svg>
          </div>
          <div class="results-popu-arraw video-swiper-next-popup">
            <svg xmlns="http://www.w3.org/2000/svg" width="57" height="57" viewBox="0 0 57 57" fill="none">
              <circle cx="28" cy="28" r="28" transform="matrix(1 -8.74228e-08 -8.74228e-08 -1 0.816895 56.7557)"
                fill="#190A0A" fill-opacity="0.6" />
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M23.7765 47.0486L23.0694 47.7557L21.6552 46.3415L22.3623 45.6344L28.818 39.1787L34.9032 33.0935C35.6843 32.3124 36.9506 32.3124 37.7317 33.0935L30.2322 40.5929L23.7765 47.0486ZM41.2765 28.1344C41.667 28.5249 41.667 29.1581 41.2765 29.5486C41.145 29.6801 40.986 29.7673 40.818 29.8103L40.818 29.8415L40.5716 29.8415L40.5672 29.8415L39.818 29.8415L29.5674 29.8415L19.3169 29.8415L16.8168 29.8415C15.7122 29.8415 14.8168 28.9461 14.8168 27.8415L19.3169 27.8415L38.1552 27.8415L22.3623 12.0486L21.6552 11.3415L23.0694 9.92731L23.7765 10.6344L41.2765 28.1344Z"
                fill="white" />
            </svg>
          </div>
        </div>
      </div>
      <div class="small-window-ulike">
        <div class="small-window-ulike-cont">
          <div class="small-window-ulike-v">
            <div class="small-window-ulike-close">
              <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">
                <path d="M17.2188 4.42651L4.21875 17.4265" stroke="white" stroke-width="1.4" stroke-linecap="round"
                  stroke-linejoin="round" />
                <path d="M4.21875 4.42651L17.2188 17.4265" stroke="white" stroke-width="1.4" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </div>
            <video src="" playsinline="true" class="small-window-video"></video>
          </div>
        </div>
      </div>
    </div>
    <canvas id="canvas" style="display:none;"></canvas>
  </results-reviews-video>

  <script>
    class resultsReviewsVideo extends HTMLElement {
      constructor() {
        super();
        this.el = this
        this.videoType = 0 //视频类型
        this.videoSwiper = null //视频swiper
        this.popupSwiper = null //弹窗视频swiper
        this.videoEl = null //当前播放视频元素
        this.handleEnded = null; // 保存事件处理器
        this.realIndex = null //当前视频索引
        this.currentShare = null //当前分享
        this.isSmall = false //是否是小窗口放大
        this.smallIndex = null //小窗口视频索引
        this.currentTime = 0 //当前播放时间

        this.data = [  //视频数据
          {
            id: '1',
            type: 0,
            img: './images47/v2.jpg',
            tag: 'BEAUTY EXPERT',
            video: '//xevu5qwwm8c80rz8-65690796273.shopifypreview.com/cdn/shop/videos/c/vp/5a8bc8897293476ea4c4d590aeab819a/5a8bc8897293476ea4c4d590aeab819a.HD-1080p-2.5Mbps-40574536.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0',
            type: 0,
            img: './images47/v3.jpg',
            tag: 'BEAUTY EXPERT',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0qwe',
            type: 0,
            img: './images47/v4.jpg',
            tag: 'BEAUTY EXPERT',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0we',
            type: 0,
            img: './images47/v5.jpg',
            tag: 'BEAUTY EXPERT',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0tyrty',
            type: 0,
            img: './images47/v6.jpg',
            tag: 'BEAUTY EXPERT',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0fg',
            type: 0,
            img: './images47/v7.jpg',
            tag: 'BEAUTY EXPERT',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0asd',
            type: 1,
            img: './images47/v2.jpg',
            tag: '',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          },
          {
            id: '0asd',
            type: 1,
            img: './images47/v3.jpg',
            tag: '',
            video: './images47/video.mp4',
            dzTxt: 456,
            proImg: './images47/pro.png',
            proName: 'Air 10',
            proPrice: '$299',
            proPriceOld: '$429',
            proBtn: 'Add to Cart',
            proId: 13213,
            muted: true
          }
        ]

        this.init();
      }
      init() {
        let that = this;
        this.setDzData();
        let list = that.data.filter(item => item.type === 0)
        this.buildHtml(list);
        // 合并监听点击事件
        this.el.addEventListener('click', (event) => {
          const target = event.target;

          // 处理加入购物车
          const addToCartButton = target.closest('.results-reviews-video-btn');
          if (addToCartButton) {
            const pId = addToCartButton.getAttribute('data-proId');
            that.toggleLoading(true);
            setTimeout(() => {
              that.toggleLoading(false);
            }, 3000);
            return; // 防止继续执行后面的代码
          }

          // 处理点赞或取消
          const likeButton = target.closest('.results-reviews-video-dz');
          if (likeButton) {
            const parentItem = likeButton.closest('.results-reviews-video-item');
            if (!parentItem) return;
            const id = parentItem.getAttribute('data-id');
            let dzItem = that.setDzData(true, id, true); // 获取点赞数据 和 执行了点赞缓存数据更新(第三个参数为true)
            const span = likeButton.querySelector('span');
            if (!dzItem.isDz) {
              likeButton.classList.remove('active');
            } else {
              likeButton.classList.add('active');
            }
            if (span) {
              span.textContent = dzItem.num;
            }
            return; // 防止继续执行后面的代码
          }

          // 播放视频
          const playButton = target.closest('.results-reviews-video-el');
          if (playButton) {
            event.stopPropagation();
            const popupBox = playButton.closest('.results-reviews-video-popup');
            this.closeSmallWindow()
            if (!popupBox) {
              const closBox = playButton.closest('.results-reviews-video-list');
              const parentItem = playButton.closest('.results-reviews-video-item');
              let index = Array.from(closBox.children).indexOf(parentItem)
              if (that.isMobile()) {
                if (!parentItem.classList.contains('swiper-slide-active')) return
                // 当前视频播放状态点击暂停
                if (!playButton.paused) {
                  playButton.pause()
                  parentItem.querySelector('.results-reviews-video-img').classList.remove('play-no');
                  return
                }
                if (that.videoEl && !that.videoEl.paused) that.videoEl.pause();
                that.videoEl = playButton
                parentItem.querySelector('.results-reviews-video-img').classList.add('play-no');
                that.videoEl.loop = true;
                that.playVideo()
                return;
              }
              parentItem.classList.remove('play-no');
              if (!playButton.paused) playButton.pause();
              that.isSmall = true;
              that.currentTime = playButton.currentTime
              that.openPopup(index)
            }
            return; // 防止继续执行后面的代码
          }

          // 关闭弹窗
          const closeButton = target.closest('.results-popu-close');
          if (closeButton) {
            this.closePopup();
            return; // 防止继续执行后面的代码
          }

          // 小窗播放视频
          const playVideoButton = target.closest('.results-popu-zoom');
          if (playVideoButton) {
            this.openSmallWindow();
            this.closePopup();
            return; // 防止继续执行后面的代码
          }

          // 声音开关
          const muteButton = target.closest('.results-reviews-video-muted');
          if (muteButton) {
            let playItem = target.closest('.results-reviews-video-item')
            let popupEl = muteButton.closest('.results-reviews-video-popup')
            let id = playItem.getAttribute('data-id');
            let isMuted = muteButton.getAttribute('data-muted') == 'true' ? true : false;
            if (popupEl) {
              if (this.videoEl) {
                this.videoEl.muted = !isMuted
              }
            }
            muteButton.setAttribute('data-muted', !isMuted);
            that.el.querySelector('.results-reviews-video-cont .results-reviews-video-item[data-id="' + id + '"]').classList[isMuted ? 'add' : 'remove']('muted-no');
            that.el.querySelector('.results-reviews-video-cont .results-reviews-video-item[data-id="' + id + '"] .results-reviews-video-muted').setAttribute('data-muted', !isMuted);
            that.el.querySelector('.results-reviews-video-cont .results-reviews-video-item[data-id="' + id + '"] .video-box').muted = !isMuted
            playItem.classList[isMuted ? 'add' : 'remove']('muted-no');
            that.data = that.data.map(item =>
              item.id === id
                ? { ...item, muted: !isMuted }
                : item
            );
            return; // 防止继续执行后面的代码
          }

          // tab切换
          const videoTab = target.closest('.results-reviews-video-tab');
          if (videoTab) {
            if (this.videoEl && !that.videoEl.paused) that.videoEl.pause();
            if (this.isMobile()) this.el.querySelector('.results-reviews-video-list .play-no')?.classList.remove('play-no');
            const allTabs = this.el.querySelectorAll('.results-reviews-video-tab');
            allTabs.forEach(tab => tab.classList.remove('active'));
            videoTab.classList.add('active');
            that.videoType = parseInt(videoTab.getAttribute('data-type'), 10);
            const list = that.data.filter(item => item.type === that.videoType);
            that.buildHtml(list);
            return; // 防止继续执行后面的代码
          }

          // 点击分享按钮
          const shareButton = target.closest('.results-reviews-video-share');
          if (shareButton) {
            const parentItem = shareButton.closest('.results-reviews-video-item');
            if (!parentItem) return;
            let id = parentItem.getAttribute('data-id');
            this.currentShare = that.data.find(item => item.id === id);
            if (!this.currentShare) return;
            let shareBox = this.el.querySelector('.results-reviews-video-share-popup');
            if (shareBox) {
              shareBox.querySelector('.results-reviews-video-copy-txt').innerHTML = this.currentShare.video;
              shareBox.querySelector('.results-reviews-video-copy-txt').setAttribute('title', this.currentShare.video);
              shareBox.style.display = 'block';
            }
            return; // 防止继续执行后面的代码
          }

          // 点击关闭分享弹窗并清除保存的分享数据
          const closeShareButton = target.closest('.results-reviews-video-share-close');
          if (closeShareButton) {
            this.currentShare = null;
            let shareBox = this.el.querySelector('.results-reviews-video-share-popup');
            if (shareBox) {
              shareBox.style.display = 'none';
            }
            return; // 防止继续执行后面的代码
          }

          // 点击复制分享链接
          const copyButton = target.closest('.results-reviews-video-copy-btn');
          if (copyButton) {
            let shareBox = this.el.querySelector('.results-reviews-video-share-popup');
            if (shareBox) {
              let text = shareBox.querySelector('.results-reviews-video-copy-txt').innerText || '';
              navigator.clipboard.writeText(text)
                .then(() => {
                  console.log('复制成功!');
                  this.createMessage('Link copied to clipboard', 1000);
                })
                .catch((err) => {
                  console.error('复制失败:', err);
                });
            }
            return; // 防止继续执行后面的代码
          }

          // 关闭小窗播放视频
          const smallWindowCloseButton = target.closest('.small-window-ulike-close');
          if (smallWindowCloseButton) {
            this.closeSmallWindow();
            return; // 防止继续执行后面的代码
          }

          // 小窗视频点击回到弹窗放大 small-window-video
          const smallWindowVideo = target.closest('.small-window-video');
          if (smallWindowVideo) {
            this.currentTime = smallWindowVideo.currentTime;
            if (this.isMobile()) {
              this.videoEl.currentTime = this.currentTime;
              this.videoEl.play();
              this.scrollToTopOfElement(this.el)
              this.closeSmallWindow()
              return
            }
            this.isSmall = true;
            this.closeSmallWindow()
            this.openPopup(this.smallIndex)
            return; // 防止继续执行后面的代码
          }

        });

        // 监听滚动后播放的视频是否在可视区域，如果不在可视区域则小窗播放
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            const ratio = entry.intersectionRatio;

            if (ratio === 1) {
              let mVideo = that.el.querySelector('.small-window-video');
              if (mVideo && !mVideo.paused) {
                this.videoEl.currentTime = mVideo.currentTime;
                this.videoEl.play();
                this.videoEl.closest('.results-reviews-video-img').classList.add('play-no');
                that.closeSmallWindow();
              }
            } else if (ratio <= 0.8 && ratio > 0) {
              if (this.videoEl && !that.videoEl.paused) {
                that.videoEl.pause();
                that.openSmallWindow()
              }
            }
          });
        }, {
          threshold: [0.8, 1] // 设置阈值，用于监听完全进入和 20% 离开
        });

        if (this.isMobile()) {
          return observer.observe(this.el.querySelector('.results-reviews-video-cont'));
          let playBox = this.el.querySelector('.play-no');
          if (this.videoEl && !that.videoEl.paused && playBox) observer.observe(playBox);
        }

        // 鼠标hover播放视频
        this.el.addEventListener('mouseover', (event) => {
          const target = event.target;
          const videoImg = target.closest('.results-reviews-video-img');
          if (videoImg && !this.isMobile()) {
            if (videoImg.closest('.results-reviews-video-popup')) return;
            let video = videoImg.querySelector('.video-box')
            videoImg.classList.add('play-no');
            video.loop = true; // 设置循环播放
            if (Math.floor(video.currentTime) >= Math.floor(video.duration)) video.currentTime = 0; // 如果当前时间大于视频总时长则重置
            video.play();
          }
        })

        // 鼠标移出暂停视频
        this.el.addEventListener('mouseout', (event) => {
          const target = event.target;
          const videoImg = target.closest('.results-reviews-video-img');
          if (videoImg && !this.isMobile()) {
            if (videoImg.closest('.results-reviews-video-popup')) return;
            let video = videoImg.querySelector('.video-box')
            videoImg.classList.remove('play-no');
            if (!video.paused) video.pause();
          }
        });
      }

      setPoster(el) {
        let videoList = el.querySelectorAll('.video-box')
        const canvas = this.el.querySelector('#canvas');
        const context = canvas.getContext('2d');
        videoList.forEach(item => {
          item.addEventListener('loadeddata', () => {
            item.currentTime = 1; // 设置到第1秒
          });

          item.addEventListener('seeked', () => {
            canvas.width = item.videoWidth;
            canvas.height = item.videoHeight;
            context.drawImage(item, 0, 0, canvas.width, canvas.height);

            const posterDataUrl = canvas.toDataURL('image/jpeg');
            item.setAttribute('poster', posterDataUrl);
          });
        })
      }

      // 滚动到顶部
      scrollToTopOfElement(element) {
        if (!element) return;
        element.scrollIntoView({
          behavior: 'smooth', // 平滑滚动
          block: 'start',     // 滚动到目标元素顶部
          inline: 'nearest',  // 水平方向的对齐方式
        });
      }

      // 判断是否移动端（小于768）
      isMobile() {
        return window.innerWidth < 768;
      }
      // 提示消息
      createMessage(content, duration = 3000) {
        // 创建一个 div 元素
        if (document.querySelector('.message-ulike')) {
          return document.querySelector('.message-ulike').textContent = content;
        }
        const message = document.createElement('div');
        message.className = 'message-ulike';
        message.textContent = content; // 设置提示内容
        message.style.position = 'fixed';
        message.style.top = '50%';
        message.style.left = '50%';
        message.style.transform = 'translate(-50%, -50%)'; // 屏幕居中
        message.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
        message.style.color = '#fff';
        message.style.padding = '0 16px';
        message.style.lineHeight = '44px';
        message.style.fontSize = '14px';
        message.style.textAlign = 'center';
        message.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.1)';
        message.style.opacity = '1';
        message.style.transition = 'opacity 0.3s ease';
        message.style.zIndex = '11';
        document.body.appendChild(message); // 添加到文档中

        // 一段时间后移除提示
        setTimeout(() => {
          message.style.opacity = '0'; // 渐隐效果
          message.addEventListener('transitionend', () => {
            document.body.removeChild(message); // 动画结束后移除元素
          });
        }, duration);
      }

      // 小窗播放视频
      openSmallWindow() {
        let popupEl = document.querySelector('.small-window-ulike');
        let videoSm = popupEl.querySelector('.small-window-video')
        let videoSrc = `${this.videoEl.src || this.videoEl.querySelector('source')?.src}`
        let videoCuTime = this.videoEl?.currentTime || 0;
        let videoMuted = this.videoEl?.muted || false;
        videoSm.src = videoSrc;
        videoSm.muted = videoMuted;
        videoSm.currentTime = videoCuTime;
        videoSm.loop = true;
        popupEl.classList.add(this.isMobile() ? 'small-mobile' : 'small-box');
        if (!this.isMobile()) this.smallIndex = this.el.querySelector('.results-reviews-video-popup .swiper-slide-active').getAttribute('data-swiper-slide-index') * 1;
        setTimeout(() => {
          videoSm.play();
        }, 400);
      }

      // 关闭小窗播放视频
      closeSmallWindow() {
        let popupEl = this.el.querySelector('.small-window-ulike');
        popupEl.classList.remove(this.isMobile() ? 'small-mobile' : 'small-box');
        popupEl.querySelector('.small-window-video').pause();
        if (this.isMobile() && this.el.querySelector('.play-no') && this.videoEl.paused) this.el.querySelector('.play-no').classList.remove('play-no');
      }

      // 关闭弹窗
      closePopup() {
        if (this.videoEl) {
          this.videoEl.currentTime = 0;
          if (!this.videoEl.paused) this.videoEl.pause();
          this.removeVideoEndedListener()
        }
        this.realIndex = null
        this.videoEl = null
        document.body.classList.remove('open-popup');
      }

      // 打开弹窗
      openPopup(index) {
        let list = this.data.filter(item => item.type === this.videoType);
        this.buildHtml(list, true);
        this.swiperInitPopup(index)
        document.body.classList.add('open-popup');
      }

      // 监听视频ended 切换swiper下一个
      playVideoEnded() {
        if (!this.videoEl) return;
        // 如果已经有绑定的处理器，先移除
        if (this.handleEnded) {
          this.videoEl.removeEventListener('ended', this.handleEnded);
        }
        // 创建一个新的处理器
        this.handleEnded = () => {
          this.videoEl.currentTime = 0;
          this.videoEl.pause();
          this.popupSwiper.slideNext();
          // 移除当前事件监听器
          this.videoEl.removeEventListener('ended', this.handleEnded);
        };

        // 添加ended事件监听器
        this.videoEl.addEventListener('ended', this.handleEnded);
      }
      // 移除ended事件监听器
      removeVideoEndedListener() {
        if (this.videoEl && this.handleEnded) {
          this.videoEl.removeEventListener('ended', this.handleEnded);
          this.handleEnded = null; // 清空处理器引用
        }
      }

      // 播放视频
      playVideo() {
        if (this.videoEl) {
          // this.videoEl.playbackRate = 6 设置倍数播放
          if (!this.videoEl.paused) {
            // this.videoEl.pause();
          } else {
            if (this.isSmall) {
              this.videoEl.currentTime = this.currentTime;
              this.isSmall = false;
            }
            if (Math.floor(this.videoEl.currentTime) >= Math.floor(this.videoEl.duration)) this.videoEl.currentTime = 0;
            this.videoEl.play();
          }
        }
        if (this.isMobile()) return;
        this.playVideoEnded();
      }

      // 初始设置点赞数据
      setDzData(isGetItem = false, id, isDzTap = false) {
        const dzList = localStorage.getItem('dzListVideo') ? JSON.parse(localStorage.getItem('dzListVideo')) : [];
        if (isGetItem) {
          // 根据id获取点赞数据
          const dzIndex = dzList.findIndex(dz => dz.id === id);
          if (isDzTap) {
            // 执行点赞数据更新
            dzList[dzIndex].num = dzList[dzIndex].num > dzList[dzIndex].randomNum ? dzList[dzIndex].num + (dzList[dzIndex].isDz ? -1 : 1) : dzList[dzIndex].randomNum + (dzList[dzIndex].isDz ? -1 : 1);
            dzList[dzIndex].isDz = !dzList[dzIndex].isDz
            if (!dzList[dzIndex].isDz && dzList[dzIndex].randomNum < dzList[dzIndex].num) {
              dzList[dzIndex].randomNum = dzList[dzIndex].num
            }
            localStorage.setItem('dzListVideo', JSON.stringify(dzList));
            return { ...dzList[dzIndex] }
          }
          if (dzIndex !== -1) {
            return { ...dzList[dzIndex] };
          } else {
            return { oldNum: 0, num: 0, isDz: false };
          }
        } else {
          this.data.forEach(item => {
            const dzIndex = dzList.findIndex(dz => dz.id === item.id);
            // 有缓存更新缓存点赞数据
            if (dzIndex !== -1) {
              // 判断初始数据和缓存点赞oldNum是否一致，不一致则更新缓存数据
              if (dzList[dzIndex].oldNum !== item.dzTxt) {
                dzList[dzIndex] = { id: item.id, num: item.dzTxt || 0, oldNum: item.dzTxt || 0, randomNum: item.dzTxt || 0, isDz: dzList[dzIndex].isDz || false };
              } else {
                // 点赞数据和缓存点赞oldNum一致，则增加点赞数量
                dzList[dzIndex] = { id: item.id, num: this.addDzNum(dzList[dzIndex].num || 0), oldNum: item.dzTxt || 0, randomNum: this.addDzNum(dzList[dzIndex].randomNum || 0), isDz: dzList[dzIndex].isDz || false };
              }
            } else {
              // 没有缓存，则新增点赞数据
              dzList.push({ id: item.id, num: item.dzTxt || 0, oldNum: item.dzTxt || 0, randomNum: item.dzTxt || 0, isDz: false });
            }
          });
        }
        localStorage.setItem('dzListVideo', JSON.stringify(dzList));
      }

      // 随机返回范围内的数字
      getRandomArbitrary(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      // 增加点赞数量
      addDzNum(num) {
        // 刷新概率百分之20增加点赞数量
        return this.getRandomArbitrary(0, 10) > 2 ? num + this.getRandomArbitrary(1, 3) : num;
      }

      // 定义遮罩方法
      toggleLoading(isOpen) {
        let overlay = document.getElementById('loading-overlay');
        let styleElement = document.getElementById('loading-style');

        if (isOpen) {
          if (!overlay) {
            // 创建遮罩层
            overlay = document.createElement('div');
            overlay.id = 'loading-overlay';
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.6)';
            overlay.style.zIndex = '1000';
            overlay.style.display = 'flex';
            overlay.style.justifyContent = 'center';
            overlay.style.alignItems = 'center';

            // 创建转圈动画
            const spinner = document.createElement('div');
            spinner.style.width = '40px';
            spinner.style.height = '40px';
            spinner.style.border = '3px solid #aaa';
            spinner.style.borderTop = '3px solid #e0004d';
            spinner.style.borderRadius = '50%';
            spinner.style.animation = 'ulikeSpin 1s linear infinite';

            overlay.appendChild(spinner);
            document.body.appendChild(overlay);

            // 添加 CSS 动画
            if (!styleElement) {
              styleElement = document.createElement('style');
              styleElement.id = 'loading-style';
              styleElement.innerHTML = `
                  body{
                    overflow: hidden;
                  }
                  @keyframes ulikeSpin {
                      0% { transform: rotate(0deg); }
                      100% { transform: rotate(360deg); }
                  }
                `;
              document.head.appendChild(styleElement);
            }
          }
        } else {
          // 移除遮罩层和样式
          if (overlay) {
            overlay.remove();
          }
          if (styleElement) {
            styleElement.remove();
          }
        }
      }


      // 轮播初始化
      swiperInit() {
        if (this.videoSwiper) this.videoSwiper.destroy(true, true);
        this.videoSwiper = new Swiper(".results-reviews-video-cont", {
          slidesPerView: "auto",
          spaceBetween: 10,
          navigation: {
            nextEl: ".video-swiper-next",
            prevEl: ".video-swiper-prev",
          },
        });
        if (this.isMobile()) {
          // 监听 transitionStart 事件
          this.videoSwiper.on('transitionStart', (e) => {
            this.el.querySelector('.results-reviews-video-list .play-no')?.classList.remove('play-no');
            if (this.videoEl && !this.videoEl.paused) {
              // 暂停视频
              this.videoEl.pause();
            }
          })
          // 监听 transitionEnd 事件
          this.videoSwiper.on('transitionEnd', (e) => {
            if (this.realIndex == null) {
              this.realIndex = e.realIndex
              this.videoEl = this.el.querySelector('.results-reviews-video-list .swiper-slide-active .video-box');
              this.el.querySelector('.results-reviews-video-list .swiper-slide-active .results-reviews-video-img').classList.add('play-no');
              this.videoEl.loop = true;
              this.playVideo();
              return
            }
            if (this.realIndex == e.realIndex) {
              if (this.videoEl && this.videoEl.paused) {
                if (Math.floor(this.videoEl.currentTime) >= Math.floor(this.videoEl.duration)) this.videoEl.currentTime = 0;
                this.el.querySelector('.results-reviews-video-list .swiper-slide-active .results-reviews-video-img').classList.add('play-no');
                this.videoEl.loop = true;
                this.videoEl.play();
              }
              return
            }
            this.realIndex = e.realIndex
            // if (this.videoEl) {
            // 更新视频元素并播放
            this.videoEl = this.el.querySelector('.results-reviews-video-list .swiper-slide-active .video-box');
            if (this.videoEl) {
              this.el.querySelector('.results-reviews-video-list .swiper-slide-active .results-reviews-video-img').classList.add('play-no');
              this.videoEl.loop = true;
              this.playVideo();
            }
            // }
          });
        }
      }

      // 弹窗轮播初始化
      swiperInitPopup(num = 0) {
        if (this.popupSwiper) this.popupSwiper.destroy(true, true);
        this.popupSwiper = new Swiper('.results-popu-cont', {
          initialSlide: num,
          autoplay: false,
          slidesPerView: "auto",
          // 当前active的slide居中-最前面的大图
          centeredSlides: true,
          effect: "creative",
          loop: true,
          grabCursor: true,
          creativeEffect: {
            prev: {
              translate: ["-53%", 0, 0], // 偏移量
              scale: 0.85, // 缩放量
              shadow: true, // 是否加阴影
            },
            next: {
              translate: ["53%", 0, 0],
              scale: 0.85,
              shadow: true,
            },
            limitProgress: 2, // 显示五个堆叠的最重要的这个属性，后面依次以前面属性等比配置
            shadowPerProgress: true, //是否等比配置透明度
          },
          navigation: {
            nextEl: '.video-swiper-next-popup',
            prevEl: '.video-swiper-prev-popup',
          },
          on: {

          }
        });
        // 监听 transitionStart 事件
        this.popupSwiper.on('transitionStart', (e) => {
          if (this.videoEl && !this.videoEl.paused) {
            // 暂停视频
            this.removeVideoEndedListener();
            this.videoEl.pause();
          }
        })
        // 监听 transitionEnd 事件
        this.popupSwiper.on('transitionEnd', (e) => {
          if (this.realIndex == null) {
            this.realIndex = e.realIndex
            this.videoEl = this.el.querySelector('.results-reviews-video-popup .swiper-slide-active .video-box');
            this.playVideo();
            this.videoEl.addEventListener('canplay', () => {
              this.toggleLoading(false);
              this.el.querySelector('.results-reviews-video-popup').style.opacity = 1;
            });
            return
          }
          if (this.realIndex == e.realIndex) {
            if (this.videoEl && this.videoEl.paused) {
              if (Math.floor(this.videoEl.currentTime) >= Math.floor(this.videoEl.duration)) this.videoEl.currentTime = 0;
              this.videoEl.play();
            }
            return
          }
          this.realIndex = e.realIndex
          this.removeVideoEndedListener()
          if (this.videoEl) {
            setTimeout(() => {
              // 更新视频元素并播放
              this.videoEl = this.el.querySelector('.results-reviews-video-popup .swiper-slide-active .video-box');
              if (this.videoEl) {
                this.playVideo();
              }
            }, 500);
          }
        });

      }
      // 更新html
      buildHtml(list = [], isPopup = false) {
        let html = '';
        list.forEach((item, index) => {
          let dzItem = this.setDzData(true, item.id)
          html += `
            <div class="results-reviews-video-item swiper-slide ${item.muted ? '' : 'muted-no'}" data-id="${item.id}">
              <div class="results-reviews-video-img">
                <div class="results-reviews-video-pos">
                  <img src="${item.img}" class="img" alt="">
                  <video playsinline="true" ${item.muted ? 'muted' : ''} class="results-reviews-video-el video-box">
                      <source src="${item.video}" type="video/mp4">
                  </video>
                  ${item.tag ? `<div class="results-reviews-video-tag">${item.tag}</div>` : ''}
                  <div class="results-reviews-video-muted" data-muted="${item.muted}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">
                      <g filter="url(#filter0_b_309_60828)">
                        <rect width="30" height="30" rx="15" fill="#190A0A" fill-opacity="0.6" />
                        <path
                          d="M14.3711 11.7205C14.3711 11.1615 13.7245 10.8507 13.288 11.1999L11.0378 13H9.03776C8.66957 13 8.37109 13.2985 8.37109 13.6667V16.3334C8.37109 16.7016 8.66957 17 9.03776 17H11.0378L13.288 18.8002C13.7245 19.1494 14.3711 18.8386 14.3711 18.2796V11.7205Z"
                          fill="white" />
                        <path class="n-muted" d="M20.998 13.0001L16.998 17.0001" stroke="white" stroke-width="1.33333"
                          stroke-linecap="round" stroke-linejoin="round" />
                        <path class="n-muted" d="M16.998 13.0001L20.998 17.0001" stroke="white" stroke-width="1.33333"
                          stroke-linecap="round" stroke-linejoin="round" />
                        <path class="h-muted"
                          d="M19.074 10.7867C20.3238 12.0369 21.0259 13.7323 21.0259 15.5001C21.0259 17.2678 20.3238 18.9632 19.074 20.2134M16.7207 13.1401C17.3456 13.7652 17.6967 14.6129 17.6967 15.4967C17.6967 16.3806 17.3456 17.2283 16.7207 17.8534"
                          stroke="white" stroke-width="1.33333" stroke-linecap="round" stroke-linejoin="round" />
                      </g>
                    </svg>
                  </div>
                  <div class="results-reviews-video-play">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">
                      <path
                        d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"
                        fill="#190A0A" fill-opacity="0.6" />
                      <path d="M16 11.9999L24.7989 17.8658L25.9133 18.6087L27.1718 19.4477L28 19.9999L16 27.9999V11.9999Z"
                        stroke="white" stroke-width="1.42857" stroke-linecap="round" stroke-linejoin="round" />
                      <path class="v-zt" fill-rule="evenodd" clip-rule="evenodd"
                        d="M22.2394 26.2111L22.2394 12.8824C23.0284 12.8824 23.668 13.522 23.668 14.311L23.668 26.2111L22.2394 26.2111Z"
                        fill="white" />
                      <path class="v-zt" fill-rule="evenodd" clip-rule="evenodd"
                        d="M16.3331 26.2111L16.3331 12.8824C17.1221 12.8824 17.7617 13.522 17.7617 14.311L17.7617 26.2111L16.3331 26.2111Z"
                        fill="white" />
                    </svg>
                  </div>
                  <div class="results-reviews-video-share">
                    <div class="results-reviews-video-dz ${dzItem.isDz ? 'active' : ''}">
                      <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 41 41" fill="none">
                        <circle cx="20.2812" cy="20.6901" r="20" fill="#190A0A" fill-opacity="0.6" />
                        <path
                          d="M16.3457 19.8771L19.5973 12.561C20.2441 12.561 20.8644 12.818 21.3218 13.2753C21.7791 13.7327 22.036 14.3529 22.036 14.9997V18.2513H26.637C26.8727 18.2487 27.1061 18.2973 27.3212 18.3938C27.5362 18.4903 27.7276 18.6324 27.8823 18.8102C28.0369 18.9881 28.1511 19.1974 28.2168 19.4237C28.2825 19.6501 28.2982 19.888 28.2628 20.121L27.141 27.4371C27.0822 27.8248 26.8853 28.1781 26.5866 28.4321C26.2878 28.686 25.9073 28.8234 25.5152 28.819H16.3457M16.3457 19.8771V28.819M16.3457 19.8771H13.907C13.4759 19.8771 13.0623 20.0484 12.7574 20.3533C12.4525 20.6582 12.2812 21.0717 12.2812 21.5029V27.1932C12.2812 27.6244 12.4525 28.0379 12.7574 28.3428C13.0623 28.6477 13.4759 28.819 13.907 28.819H16.3457"
                          stroke="white" stroke-width="0.812899" stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                      <span>${dzItem.isDz ? dzItem.num : (dzItem.randomNum || item.dzTxt || 0)}</span>
                    </div>
                    <div class="results-reviews-video-fx">
                      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" fill="none">
                        <g filter="url(#filter0_b_345_70967)">
                          <rect width="40" height="40" rx="20" fill="#190A0A" fill-opacity="0.6" />
                          <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M24.8617 26.5347C26.133 26.5347 27.1636 25.5041 27.1636 24.2328C27.1636 22.9614 26.133 21.9308 24.8617 21.9308C23.5903 21.9308 22.5597 22.9614 22.5597 24.2328C22.5597 25.5041 23.5903 26.5347 24.8617 26.5347ZM28.0007 24.2328C28.0007 25.9664 26.5953 27.3718 24.8617 27.3718C23.128 27.3718 21.7227 25.9664 21.7227 24.2328C21.7227 22.4991 23.128 21.0938 24.8617 21.0938C26.5953 21.0938 28.0007 22.4991 28.0007 24.2328Z"
                            fill="white" />
                          <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M15.139 22.5118C16.4103 22.5118 17.441 21.4811 17.441 20.2098C17.441 18.9385 16.4103 17.9079 15.139 17.9079C13.8677 17.9079 12.8371 18.9385 12.8371 20.2098C12.8371 21.4811 13.8677 22.5118 15.139 22.5118ZM18.278 20.2098C18.278 21.9435 16.8726 23.3488 15.139 23.3488C13.4054 23.3488 12 21.9435 12 20.2098C12 18.4762 13.4054 17.0708 15.139 17.0708C16.8726 17.0708 18.278 18.4762 18.278 20.2098Z"
                            fill="white" />
                          <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M24.8617 18.0691C26.133 18.0691 27.1636 17.0385 27.1636 15.7672C27.1636 14.4959 26.133 13.4652 24.8617 13.4652C23.5903 13.4652 22.5597 14.4959 22.5597 15.7672C22.5597 17.0385 23.5903 18.0691 24.8617 18.0691ZM28.0007 15.7672C28.0007 17.5008 26.5953 18.9062 24.8617 18.9062C23.128 18.9062 21.7227 17.5008 21.7227 15.7672C21.7227 14.0336 23.128 12.6282 24.8617 12.6282C26.5953 12.6282 28.0007 14.0336 28.0007 15.7672Z"
                            fill="white" />
                          <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M17.8145 22.2395C18.0657 21.729 18.6757 21.5085 19.1953 21.7407L22.7122 23.3119L22.2622 24.2266L17.8145 22.2395Z"
                            fill="white" />
                          <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M22.7851 17.1252L19.2338 18.7747C18.724 19.0115 18.1188 18.7884 17.8847 18.2773L22.3605 16.1984L22.7851 17.1252Z"
                            fill="white" />
                        </g>
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
              <div class="results-reviews-video-text">
                <img src="${item.proImg}" alt="" class="pro-img">
                <div class="results-reviews-product-txt">
                  <div class="results-reviews-video-name">${item.proName}</div>
                  <div class="results-reviews-video-price">
                    <span class="n-price">${item.proPrice}</span>
                    <span class="d-price">${item.proPriceOld}</span>
                  </div>
                  <div class="results-reviews-video-btn" data-proId = "${item.proId}">
                    ${item.proBtn}
                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="12" viewBox="0 0 15 12" fill="none">
                      <path d="M0.950195 5.8656L14.0372 5.86499" stroke="#190A0A" stroke-width="0.608696" />
                      <path d="M11.2979 3.12585L14.5032 5.86559L11.2979 8.53594" stroke="#190A0A" stroke-width="0.608696"
                        stroke-linejoin="round" />
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            `
        })
        if (isPopup) {
          this.el.querySelector('.results-popu-swiper').innerHTML = html;
          this.toggleLoading(true);
          this.el.querySelector('.results-reviews-video-popup').style.opacity = 0;
          // this.swiperInitPopup()
          setTimeout(() => {
            this.setPoster(this.el.querySelector('.results-popu-swiper'))
          }, 100)
        } else {
          this.el.querySelector('.results-reviews-video-list').innerHTML = html;
          this.swiperInit()
          setTimeout(() => {
            this.setPoster(this.el.querySelector('.results-reviews-video-list'))
          }, 100)
        }
      }

    }
    // new resultsReviewsVideo('.results-reviews-video');
    customElements.define('results-reviews-video', resultsReviewsVideo);
  </script>

  <div class="experts-new-module">
    <div class="container">
      <div class="experts-new-module-title">Recommended by experts.</div>
      <div class="experts-new-module-cont">
        <div class="experts-new-module-img">
          <img src="./images47/v1.jpg" alt="" class="img">
          <video playsinline="true" autoplay="autoplay" muted="muted" loop="loop" preload="metadata"
            class="experts-new-module-video"
            poster="//www.ulike.com/cdn/shop/files/preview_images/0b5d0cf1e68445c5b09d32549578e772.thumbnail.0000000000_small.jpg?v=1731398542">
            <source
              src="//www.ulike.com/cdn/shop/videos/c/vp/0b5d0cf1e68445c5b09d32549578e772/0b5d0cf1e68445c5b09d32549578e772.HD-1080p-7.2Mbps-37966511.mp4?v=0"
              type="video/mp4">
            <img
              src="//www.ulike.com/cdn/shop/files/preview_images/0b5d0cf1e68445c5b09d32549578e772.thumbnail.0000000000_small.jpg?v=1731398542"
              alt="video image" loading="lazy">
          </video>
        </div>
        <div class="experts-new-module-txt">
          <div class="experts-new-module-txt-title">Real Results from real people. </div>
          <div class="experts-new-module-sub">Beauty isn't just about looking — it's about feeling good too. More than
            just the before-and-after photos, it's the people behind those results and what removing unwanted hair means
            to them.</div>
          <div class="experts-new-module-p">—Board-Certified Dermatologist</div>
          <div class="experts-new-module-name">Dr. dorfman</div>
        </div>
      </div>
    </div>
  </div>

  <div class="results-reviews-banner">
    <div class="container">
      <div class="results-reviews-banner-cont">
        <div class="results-reviews-banner-img">
          <div class="results-reviews-banner-pad">
            <img src="./images47/a1.jpg" alt="" class="img">
            <video playsinline="true" autoplay="autoplay" muted="muted" loop="loop" preload="metadata"
              class="results-reviews-banner-video"
              poster="//www.ulike.com/cdn/shop/files/preview_images/0b5d0cf1e68445c5b09d32549578e772.thumbnail.0000000000_small.jpg?v=1731398542">
              <source
                src="//www.ulike.com/cdn/shop/videos/c/vp/0b5d0cf1e68445c5b09d32549578e772/0b5d0cf1e68445c5b09d32549578e772.HD-1080p-7.2Mbps-37966511.mp4?v=0"
                type="video/mp4">
              <img
                src="//www.ulike.com/cdn/shop/files/preview_images/0b5d0cf1e68445c5b09d32549578e772.thumbnail.0000000000_small.jpg?v=1731398542"
                alt="video image" loading="lazy">
            </video>
            <div class="results-reviews-banner-play">
              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="41" viewBox="0 0 40 41" fill="none"
                class="play-show-svg">
                <circle cx="20" cy="20.9375" r="20" fill="white" fill-opacity="0.4"></circle>
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M22.2394 27.1486L22.2394 13.8199C23.0284 13.8199 23.668 14.4595 23.668 15.2485L23.668 27.1486L22.2394 27.1486Z"
                  fill="white"></path>
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M16.3331 27.1486L16.3331 13.8199C17.1221 13.8199 17.7617 14.4595 17.7617 15.2485L17.7617 27.1486L16.3331 27.1486Z"
                  fill="white"></path>
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="41" viewBox="0 0 40 41" fill="none"
                class="play-hide-svg">
                <path
                  d="M20 40.9375C31.0457 40.9375 40 31.9832 40 20.9375C40 9.89181 31.0457 0.9375 20 0.9375C8.95431 0.9375 0 9.89181 0 20.9375C0 31.9832 8.95431 40.9375 20 40.9375Z"
                  fill="white" fill-opacity="0.4"></path>
                <path d="M16 12.9374L24.7989 18.8033L25.9133 19.5462L27.1718 20.3852L28 20.9374L16 28.9374V12.9374Z"
                  stroke="white" stroke-width="1.42857" stroke-linecap="round" stroke-linejoin="round"></path>
              </svg>
            </div>
          </div>
        </div>
        <div class="results-reviews-banner-txt">
          <div class="results-reviews-banner-title">Results That Empower</div>
          <div class="results-reviews-banner-sub">Beauty isn't just about looking.</div>
          <div class="results-reviews-banner-p">
            <ul>
              <li>Precise removal of stubborn hairs</li>
              <li>Precise removal of stubborn hairs</li>
              <li>Precise removal of stubborn hairs</li>
              <li>Precise removal of stubborn hairs</li>
            </ul>
          </div>
          <div class="results-reviews-banner-btn">
            SHOP NOW
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    (function () {
      // 作用域内定义变量
      const $p = document.querySelector('.results-reviews-banner');
      const video = $p.querySelector('.results-reviews-banner-video');
      const toggleButton = $p.querySelector('.results-reviews-banner-play');

      // 更新视频状态
      function updateStatus() {
        toggleButton.classList[video.paused ? "remove" : "add"]("is-play");
      }

      // 切换播放状态
      toggleButton.addEventListener('click', () => {
        if (video.paused) {
          video.play();
        } else {
          video.pause();
        }
        updateStatus();
      });

      // 监听播放和暂停事件
      video.addEventListener('play', updateStatus);
      video.addEventListener('pause', updateStatus);

      // 页面初始状态
      updateStatus();
    })(); // 立即执行函数
  </script>
  <div class="results-reviews-product-module">
    <div class="container">
      <div class="results-reviews-product-cont">
        <div class="results-reviews-product-img">
          <div class="results-reviews-product-main-img">
            <div class="results-reviews-product-big">
              <div class="results-reviews-product-big-list swiper-wrapper">
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <!-- <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg"> -->
                  <video playsinline="true" autoplay="autoplay" muted="muted" loop="loop" preload="metadata"
                    data-fancybox="prozoom"
                    data-src="//www.ulike.com/cdn/shop/videos/c/vp/0b5d0cf1e68445c5b09d32549578e772/0b5d0cf1e68445c5b09d32549578e772.HD-1080p-7.2Mbps-37966511.mp4"
                    class="results-reviews-banner-video"
                    poster="//www.ulike.com/cdn/shop/files/preview_images/0b5d0cf1e68445c5b09d32549578e772.thumbnail.0000000000_small.jpg?v=1731398542">
                    <source
                      src="//www.ulike.com/cdn/shop/videos/c/vp/0b5d0cf1e68445c5b09d32549578e772/0b5d0cf1e68445c5b09d32549578e772.HD-1080p-7.2Mbps-37966511.mp4?v=0"
                      type="video/mp4">
                    <img
                      src="//www.ulike.com/cdn/shop/files/preview_images/0b5d0cf1e68445c5b09d32549578e772.thumbnail.0000000000_small.jpg?v=1731398542"
                      alt="video image" loading="lazy">
                  </video>
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
                <div class="results-reviews-product-big-item swiper-slide">
                  <img src="./images47/p.jpg" alt="" class="img-big" data-fancybox="prozoom"
                    data-src="./images47/p.jpg">
                </div>
              </div>
              <div class="results-reviews-product-big-arraws">
                <div class="results-reviews-product-big-arraw results-reviews-product-big-prev">
                  <svg xmlns="http://www.w3.org/2000/svg" width="57" height="57" viewBox="0 0 57 57" fill="none">
                    <circle cx="28.2813" cy="28.4263" r="28" transform="rotate(-180 28.2813 28.4263)" fill="white" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M33.3216 46.7192L34.0287 47.4263L35.443 46.0121L34.7358 45.3049L28.2801 38.8492L22.1949 32.764C21.4139 31.983 20.1475 31.983 19.3665 32.764L26.8659 40.2634L33.3216 46.7192ZM15.8216 27.8049C15.4311 28.1955 15.4311 28.8286 15.8216 29.2192C15.9531 29.3507 16.1122 29.4379 16.2801 29.4808L16.2801 29.5121L16.5266 29.5121L16.5309 29.5121L17.2801 29.5121L27.5307 29.5121L37.7813 29.5121L40.2813 29.5121C41.3859 29.5121 42.2813 28.6166 42.2813 27.5121L37.7813 27.5121L18.943 27.5121L34.7359 11.7192L35.443 11.0121L34.0287 9.59784L33.3216 10.3049L15.8216 27.8049Z"
                      fill="black" />
                  </svg>
                </div>
                <div class="results-reviews-product-big-arraw results-reviews-product-big-next">
                  <svg xmlns="http://www.w3.org/2000/svg" width="57" height="57" viewBox="0 0 57 57" fill="none">
                    <circle cx="28.1562" cy="28.4263" r="28" fill="white" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M23.1159 10.1334L22.4088 9.42627L20.9945 10.8405L21.7017 11.5476L28.1574 18.0033L34.2426 24.0885C35.0236 24.8696 36.29 24.8696 37.071 24.0885L29.5716 16.5891L23.1159 10.1334ZM40.6158 29.0476C41.0064 28.6571 41.0064 28.0239 40.6158 27.6334C40.4844 27.5019 40.3253 27.4147 40.1574 27.3717L40.1574 27.3405L39.9109 27.3405L39.9066 27.3405L39.1574 27.3405L28.9068 27.3405L18.6562 27.3405L16.1562 27.3405C15.0516 27.3405 14.1562 28.2359 14.1562 29.3405L18.6562 29.3405L37.4945 29.3405L21.7016 45.1334L20.9945 45.8405L22.4088 47.2547L23.1159 46.5476L40.6158 29.0476Z"
                      fill="black" />
                  </svg>
                </div>

              </div>
              <div class="results-reviews-product-big-dot">
              </div>
            </div>
          </div>
          <div class="results-reviews-product-small">
            <div class="results-reviews-product-small-list swiper-wrapper">
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
              <div class="results-reviews-product-small-item swiper-slide">
                <img src="./images47/p.jpg" alt="" class="img-sm">
              </div>
            </div>
          </div>
        </div>
        <div class="results-reviews-product-text">
          <div class="results-reviews-product-title">Ulike Air 10</div>
          <div class="results-reviews-product-sub">IPL Hair Removal Device</div>
          <div class="results-reviews-product-star">4.8(658 reviews)</div>
          <div class="results-reviews-product-m-change">
            <div class="results-reviews-product-desc">
              <p>Next-generation IPL effectiveness.</p>
              <ul>
                <li>■ 96% hair reduction in just 2 weeks</li>
                <li>■ Long-lasting smooth skin</li>
                <li>■ Effectively removes stubborn hairs</li>
                <li>■ FDA-cleared safety & nearly painless</li>
                <li>■ Gentle on sensitive skin</li>
                <li>■ 10-minute full-body sessions</li>
              </ul>
            </div>
            <div class="results-reviews-product-colours">
              <div class="results-reviews-colours-t">
                Color: <span>Purple </span>
              </div>
              <div class="results-reviews-product-colours-list">
                <div class="results-reviews-product-colours-item">
                  <span></span>
                </div>
                <div class="results-reviews-product-colours-item">
                  <span></span>
                </div>
              </div>
            </div>
          </div>
          <div class="results-reviews-product-price">
            <span class="n-price">$399.00</span>
            <span class="d-price">$699.00</span>
            <span class="tag-label">save $300</span>
          </div>
          <div class="results-reviews-product-free">
            try free pay later with
            <svg xmlns="http://www.w3.org/2000/svg" width="81" height="25" viewBox="0 0 81 25" fill="none">
              <rect x="0.28125" y="0.45752" width="80" height="24" rx="12" fill="#FFB3C7" />
              <path
                d="M63.8863 14.6029C63.7023 14.6035 63.5201 14.6404 63.3503 14.7113C63.1806 14.7822 63.0265 14.8858 62.8969 15.0162C62.7674 15.1465 62.6649 15.301 62.5953 15.4709C62.5257 15.6407 62.4904 15.8226 62.4915 16.0061C62.4904 16.1895 62.5257 16.3714 62.5953 16.5413C62.6649 16.7111 62.7674 16.8656 62.8969 16.996C63.0265 17.1263 63.1806 17.2299 63.3503 17.3008C63.5201 17.3717 63.7023 17.4086 63.8863 17.4093C64.6558 17.4093 65.2812 16.7807 65.2812 16.0061C65.2823 15.8226 65.247 15.6407 65.1774 15.4709C65.1078 15.301 65.0053 15.1465 64.8758 15.0162C64.7462 14.8858 64.5921 14.7822 64.4224 14.7113C64.2526 14.6404 64.0704 14.6035 63.8863 14.6029ZM59.2961 13.5192C59.2961 12.4576 58.3945 11.5982 57.2823 11.5982C56.17 11.5982 55.2685 12.4589 55.2685 13.5192C55.2685 14.5794 56.1713 15.4388 57.2836 15.4388C58.3958 15.4388 59.2961 14.5794 59.2961 13.5192ZM59.3039 9.78556H61.5258V17.2515H59.3039V16.7742C58.6561 17.2198 57.8875 17.4582 57.1004 17.4575C54.9374 17.4575 53.184 15.6944 53.184 13.5192C53.184 11.3439 54.9374 9.58082 57.1004 9.58082C57.9182 9.58082 58.6758 9.83251 59.3039 10.2642V9.78556ZM41.5186 10.7584V9.78686H39.2431V17.2515H41.5238V13.7656C41.5238 12.5894 42.7905 11.9582 43.6698 11.9582H43.696V9.78686C42.7931 9.78686 41.9648 10.1755 41.5186 10.7584ZM35.8501 13.5192C35.8501 12.4576 34.9485 11.5982 33.8363 11.5982C32.7241 11.5982 31.8225 12.4589 31.8225 13.5192C31.8225 14.5794 32.7254 15.4388 33.8376 15.4388C34.9498 15.4388 35.8501 14.5794 35.8501 13.5192ZM35.858 9.78556H38.0811V17.2515H35.858V16.7742C35.2299 17.2045 34.4722 17.4575 33.6544 17.4575C31.4914 17.4575 29.738 15.6944 29.738 13.5192C29.738 11.3439 31.4914 9.58082 33.6544 9.58082C34.4722 9.58082 35.2299 9.83251 35.858 10.2642V9.78556ZM49.2349 9.58603C48.3477 9.58603 47.5077 9.8625 46.945 10.6267V9.78686H44.7323V17.2515H46.9725V13.3288C46.9725 12.1942 47.7288 11.6374 48.6408 11.6374C49.617 11.6374 50.1796 12.2242 50.1796 13.3131V17.2515H52.3989V12.5046C52.3989 10.7675 51.025 9.58603 49.2349 9.58603ZM26.5008 17.2515H28.8273V6.46013H26.5008V17.2515ZM16.2812 17.2541H18.7452V6.45752H16.2826L16.2812 17.2541ZM24.8991 6.45752C24.8991 8.79445 23.9936 10.9697 22.3789 12.5854L25.7837 17.2541H22.7414L19.0422 12.1812L19.9974 11.4613C20.7751 10.8784 21.4051 10.1224 21.8372 9.25356C22.2694 8.38473 22.4916 7.42722 22.4862 6.45752H24.8965H24.8991Z"
                fill="#3F3636" />
            </svg>
            or 4 interest-free payments of $82.25 with
            <svg xmlns="http://www.w3.org/2000/svg" width="89" height="25" viewBox="0 0 89 25" fill="none">
              <rect x="0.28125" y="0.45752" width="88" height="24" rx="12" fill="#B2FCE4" />
              <path
                d="M19.2194 12.3371C19.2194 11.3195 18.462 10.6046 17.5315 10.6046C16.6009 10.6046 15.8435 11.3319 15.8435 12.3371C15.8435 13.3305 16.6009 14.0693 17.5315 14.0693C18.4632 14.0693 19.2194 13.355 19.2194 12.3371ZM19.233 15.3655V14.5782C18.7739 15.1232 18.0901 15.4618 17.2722 15.4618C15.5718 15.4618 14.2812 14.1293 14.2812 12.3371C14.2812 10.5564 15.6211 9.20007 17.3101 9.20007C18.1049 9.20007 18.7745 9.53973 19.2336 10.0718V9.30877H20.7602V15.3655H19.233ZM28.1742 14.0206C27.6398 14.0206 27.4916 13.827 27.4916 13.3187V10.6294H28.4724V9.30819H27.4916V7.83089H25.927V9.30819H23.9119V8.94026C23.9119 8.43095 24.1111 8.23685 24.6574 8.23685H25.0004V7.06215H24.2475C22.957 7.06215 22.349 7.47422 22.349 8.73374V9.30762H21.4802V10.6294H22.349V15.3649H23.9136V10.6294H25.9287V13.5972C25.9287 14.8329 26.412 15.366 27.6777 15.366H28.485V14.0211L28.1742 14.0206ZM33.7842 11.7915C33.6727 11.0046 33.0143 10.532 32.2452 10.532C31.4753 10.532 30.8424 10.9922 30.6818 11.7915H33.7842ZM30.6688 12.7368C30.7807 13.6327 31.4385 14.1422 32.2701 14.1422C32.9278 14.1422 33.4373 13.8389 33.7344 13.3544H35.3362C34.9633 14.6382 33.7842 15.4618 32.2326 15.4618C30.3591 15.4618 29.0436 14.1785 29.0436 12.349C29.0436 10.5201 30.4338 9.19968 32.2712 9.19968C34.1205 9.19968 35.4602 10.532 35.4602 12.349C35.4602 12.4827 35.4484 12.6151 35.4235 12.7368H30.6688ZM45.4061 12.3371C45.4061 11.3556 44.6488 10.6046 43.7183 10.6046C42.7877 10.6046 42.0302 11.3319 42.0302 12.3371C42.0302 13.3305 42.7877 14.0693 43.7183 14.0693C44.6488 14.0693 45.4061 13.3187 45.4061 12.3371ZM40.4907 9.30877H42.0172V10.0962C42.4757 9.53859 43.1585 9.20007 43.9781 9.20007C45.6535 9.20007 46.9684 10.545 46.9684 12.3247C46.9684 14.106 45.6286 15.4629 43.9406 15.4629C43.1585 15.4629 42.5132 15.1595 42.0671 14.6512V17.8578H40.4907V9.30877ZM52.4703 12.3371C52.4703 11.3195 51.7142 10.6046 50.7825 10.6046C49.852 10.6046 49.0945 11.3319 49.0945 12.3371C49.0945 13.3305 49.852 14.0693 50.7825 14.0693C51.7142 14.0693 52.4703 13.355 52.4703 12.3371ZM52.4839 15.3655V14.5782C52.0248 15.1232 51.3411 15.4618 50.5233 15.4618C48.8228 15.4618 47.5322 14.1293 47.5322 12.3371C47.5322 10.5564 48.8721 9.20007 50.5605 9.20007C51.3547 9.20007 52.0248 9.53973 52.4839 10.0718V9.30877H54.0099V15.3655H52.4839ZM37.7397 9.90271C37.7397 9.90271 38.1281 9.20064 39.0795 9.20064C39.4866 9.20064 39.7498 9.33666 39.7498 9.33666V10.8818C39.7498 10.8818 39.1757 10.536 38.6483 10.6057C38.1206 10.6753 37.7873 11.1479 37.789 11.7808V15.3666H36.2131V9.30991H37.7397V9.90271ZM61.1387 9.30877L57.2851 17.8385H55.6601L57.1731 14.5408L54.6146 9.30877H56.4564L57.9532 12.8048L59.4887 9.30877H61.1387ZM73.4405 9.17122L69.6197 7.01974C68.4989 6.38807 67.0969 7.17715 67.0969 8.44164V8.66248C67.0969 8.86174 67.2061 9.04628 67.3828 9.14524L68.1044 9.55158C68.3161 9.67174 68.5799 9.52216 68.5799 9.28393V8.73489C68.5799 8.46036 68.8844 8.28824 69.1278 8.42579L72.437 10.2903C72.6803 10.4273 72.6803 10.7704 72.437 10.9074L69.1278 12.7714C68.8844 12.9083 68.5805 12.7373 68.5805 12.4622V12.1702C68.5805 10.9062 67.1784 10.1155 66.0559 10.7482L62.2351 12.9003C61.9804 13.0403 61.768 13.2461 61.62 13.4962C61.4719 13.7464 61.394 14.0316 61.394 14.3222C61.394 14.613 61.4719 14.8982 61.62 15.1483C61.768 15.3985 61.9804 15.6043 62.2351 15.7441L66.0559 17.8958C67.1773 18.5274 68.5805 17.7384 68.5805 16.4739V16.253C68.5799 16.1545 68.553 16.0576 68.5027 15.9728C68.4523 15.888 68.3803 15.818 68.2941 15.7703L67.5729 15.3626C67.3612 15.2432 67.0969 15.3926 67.0969 15.631V16.1801C67.0969 16.4546 66.7923 16.6261 66.5495 16.4886L63.24 14.6246C63.1848 14.5941 63.1387 14.5494 63.1066 14.4951C63.0745 14.4407 63.0575 14.3788 63.0575 14.3157C63.0575 14.2527 63.0745 14.1908 63.1066 14.1365C63.1387 14.0821 63.1848 14.0374 63.24 14.007L66.5495 12.1425C66.7929 12.0049 67.0969 12.1765 67.0969 12.4516V12.7437C67.0969 14.0076 68.4985 14.7983 69.6197 14.1656L73.4405 12.0133C73.695 11.8735 73.9072 11.6679 74.0551 11.418C74.2029 11.168 74.2809 10.8829 74.2809 10.5926C74.2809 10.3022 74.2029 10.0171 74.0551 9.76726C73.9072 9.51738 73.695 9.31106 73.4405 9.17122Z"
                fill="#3F3636" />
            </svg>
          </div>
          <div class="results-reviews-product-code">
            <div class="results-reviews-product-code-cont">
              <img src="./images47/jbg.jpg" class="code-bg" alt="">
              <div class="results-reviews-product-code-title">
                $190 OFF
              </div>
              <div class="results-reviews-product-code-btn">
                <div class="results-reviews-product-code-p">Copy:</div>
                <div class="results-reviews-product-code-txt">AIR1080AIR1080</div>
              </div>
              <svg xmlns="http://www.w3.org/2000/svg" width="139" height="101" viewBox="0 0 139 101" fill="none">
                <path
                  d="M98.7839 13.7812H109.072V68.7933C108.831 86.439 94.4436 97.1437 79.1033 97.1437C63.7629 97.1437 49.3903 86.439 49.1341 68.7933V0.45752H0.28125L9.61637 13.7812H19.9334V67.8345C19.9334 99.4049 50.6995 111.999 79.1175 111.913C107.536 111.999 138.302 99.4049 138.302 67.8345V0.45752H89.4488L98.7839 13.7812Z"
                  fill="url(#paint0_linear_630_14083)" fill-opacity="0.4" />
                <defs>
                  <linearGradient id="paint0_linear_630_14083" x1="76.8015" y1="-16.6719" x2="138.302" y2="122.809"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="white" stop-opacity="0.2" />
                    <stop offset="1" stop-color="#FF0020" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
          </div>
          <div class="results-reviews-product-btn">
            <div class="results-reviews-product-count">
              <div class="results-reviews-product-count-hand results-reviews-product-count-reduce"></div>
              <input type="number" value="1" class="results-reviews-product-count-num" />
              <div class="results-reviews-product-count-hand results-reviews-product-count-add"></div>
            </div>
            <div class="results-reviews-product-add-btn">
              ADD TO CART-$399.00
            </div>
          </div>
          <div class="results-reviews-product-buy"></div>
          <div class="results-reviews-product-safeguards">
            <div class="results-reviews-product-safeguard">
              <img class="icon-img" src="./images47/p1.svg" alt="">
              Fast & Free Shipping
            </div>
            <div class="results-reviews-product-safeguard">
              <img class="icon-img" src="./images47/p2.svg" alt="">
              90-Day Money Back
            </div>
            <div class="results-reviews-product-safeguard">
              <img class="icon-img" src="./images47/p3.svg" alt="">
              2-Year Warranty
            </div>
            <div class="results-reviews-product-safeguard">
              <img class="icon-img" src="./images47/p4.svg" alt="">
              24/7 Support
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    (function () {
      let thumbSwiper = null
      let mainSwiper = null

      function initSwiper() {
        // swiper 初始化之后 先卸载
        if (thumbSwiper) {
          thumbSwiper.destroy()
        }
        if (mainSwiper) {
          mainSwiper.destroy()
        }
        thumbSwiper = null
        mainSwiper = null
        // 初始化小图轮播
        thumbSwiper = new Swiper('.results-reviews-product-small', {
          direction: 'horizontal', // 垂直滚动
          slidesPerView: 'auto', // 一次显示 4 个缩略图
          spaceBetween: 10, // 缩略图间距
          watchSlidesProgress: true, // 保持缩略图的活动状态
          freeMode: true, // 启用自由模式
          breakpoints: {
            992: {
              direction: 'vertical', // 横向滚动
            },
          }
        });

        // 初始化大图轮播
        mainSwiper = new Swiper('.results-reviews-product-big', {
          loop: true, // 循环播放
          slidesPerView: 1,
          spaceBetween: 0,
          navigation: {
            nextEl: '.results-reviews-product-big-next',
            prevEl: '.results-reviews-product-big-prev',
          },
          pagination: {
            el: '.results-reviews-product-big-dot',
            clickable: true, // 点击小圆点切换
          },
          thumbs: {
            swiper: thumbSwiper, // 关联小图轮播
          },
        });
      }

      function convertShopifyImageUrl(url, size) {
        return url.replace(/(\.[^/.]+)$/, `_${size}$1`)
      }
      function generateVideoHtml(videoData) {
        var filteredData = filterAndFindMaxWidth(videoData),
          videoHtml =
            '<video id="dynamicVideo" autoplay muted loop playsinline controls>'
        return (
          Object.values(filteredData).forEach(function (video) {
            videoHtml += `<source src="${video.url}" type="${video.mime_type}">`
          }),
          (videoHtml += 'Your browser does not support the video tag.</video>'),
          videoHtml
        )
      }
      function filterAndFindMaxWidth(data) {
        var result = {}
        return (
          data.forEach(function (item) {
            ; (!result[item.mime_type] || item.width > result[item.mime_type].width) &&
              (result[item.mime_type] = item)
          }),
          result
        )
      }

      function generateHtmlForVariant(vid) {
        let variant = vid || variantArr[0].vid
        let currentVariant = variantArr[0]
        currentVariant = variantArr.filter((item) => item.vid == variant)[0]
        const { position, max } = currentVariant
        let _productHtml = '',
          _productnavHtml = ''
        for (let i = position - 1; i < max; i++) {
          const ths = productMediaArr[i]
          let imageUrl = ths.src,
            itemMainHtml = ''
          ths.alt = ths.alt ? ths.alt : 'Ulike'
          let loadingAttr =
            i == position - 1 ? 'fetchpriority="high"' : 'loading="lazy"'
          ths.media_type == 'video' ? ((imageUrl = ths.preview_image.src),
            (itemMainHtml = generateVideoHtml(ths.sources)))
            : (itemMainHtml = `
              <img src="${convertShopifyImageUrl(imageUrl, '880x')}" ${loadingAttr} class="img-big" data-fancybox="prozoom"
                data-src="${convertShopifyImageUrl(imageUrl, '880x')}" alt="${ths.alt}" media_type="${ths.media_type}">
            `)
          _productHtml += `<div class="results-reviews-product-big-item swiper-slide">${itemMainHtml}</div>`
          _productnavHtml += `<div class="results-reviews-product-small-item swiper-slide">
              <img src="${convertShopifyImageUrl(imageUrl, '80x')}" ${loadingAttr} alt="${ths.alt}" media_type="${ths.media_type}" class="img-sm">
            </div>`
        }
        $('.results-reviews-product-big-list').html(_productHtml)
        $('.results-reviews-product-small-list').html(_productnavHtml)
        initSwiper()
        if (currentVariant.price != '' && currentVariant.page_price != '') {
          $('.results-reviews-product-price .n-price').html(currentVariant.page_price)
          $('.results-reviews-product-price .d-price').html(currentVariant.price)
        }
        if (currentVariant.variantTitle != '') $('.product-info-new .product-meta__title').html(currentVariant.variantTitle)
        if (currentVariant.describe != '') $('.results-reviews-product-desc').html(currentVariant.describe)
        $('.results-reviews-product-add-btn').attr('data-vid', currentVariant.vid)
        $('.results-reviews-product-buy .buy-buttons-pid').val(currentVariant.vid)
      }

    })(); // 立即执行函数



    $('.results-reviews-product-module').on('click', '.results-reviews-product-colours-item', function () {
      let vid = $(this).attr('id')
      let name = $(this).attr('name')
      if ($(this).hasClass('active')) return
      $(this).parents().siblings('.results-reviews-colours-t').find('span').html(name)
      $(this).addClass('active').siblings().removeClass('active')
      generateHtmlForVariant(vid)
    })

  </script>
  <script>
    Fancybox.bind('[data-fancybox]', {
      Toolbar: {
        display: {
          left: [],
          middle: ["infobar"],
          right: ["close"],
        },
      },
      Thumbs: {
        showOnStart: false,
      },
      // Transition effect when changing gallery items
      Carousel: {
        transition: "slide"
      },
      // Disable image zoom animation on opening and closing
      Images: {
        zoom: true
      },
      // Custom CSS transition on opening
      showClass: "f-fadeIn"
    });    
  </script>

  <script>
    (function () {
      // 获取所有视频元素
      const videos = document.querySelectorAll('video');

      // 检查视频是否在视口内
      function isVideoVisible(video, threshold = 0.2) {
        const rect = video.getBoundingClientRect();
        const windowHeight = window.innerHeight || document.documentElement.clientHeight;

        // 计算视频在视口中可见的比例
        const visibleHeight = Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0);
        const videoHeight = rect.height;

        const visibleRatio = visibleHeight / videoHeight;

        return visibleRatio >= threshold;
      }

      // 初始化播放状态：页面加载时暂停所有不在视口的视频
      function initializeVideoState() {
        videos.forEach((video) => {
          if (!isVideoVisible(video)) {
            // 如果不在视口内，暂停
            video.pause();
          }
          if (video.autoplay) {
            video.setAttribute('data-playing', 'true')
          }
        });
      }

      // 创建 IntersectionObserver 实例
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          const video = entry.target;

          if (entry.intersectionRatio >= 0.6) {
            // 当视频可见性大于等于 20%
            if (video.getAttribute('data-playing') === 'true') {
              video.play();
            }
          } else {
            // 当视频离开视口时，记录播放状态并暂停视频
            if (!video.paused) {
              video.pause();
            }
          }
        });
      }, {
        threshold: [0, 0.6, 1.0] // 观察可见性阈值，0%、20%、100%
      });

      // 为每个视频添加观察者
      videos.forEach((video) => {
        observer.observe(video);
      });

      window.addEventListener('load', initializeVideoState);
      // 页面加载时初始化视频状态
      initializeVideoState();
    })(); // 立即执行函数
  </script>


  <script>
    function generateHtmlForVariant(vid) {
      let $el = document.querySelector('body')
      let variant = vid || variantArr[0].vid
      let currentVariant = variantArr[0]
      currentVariant = variantArr.filter((item) => item.vid == variant)[0]
      const { position, max } = currentVariant
      let _productHtml = '',
        _productnavHtml = ''
      for (let i = position - 1; i < max; i++) {
        const ths = productMediaArr[i]
        let imageUrl = ths.src,
          itemMainHtml = ''
        ths.alt = ths.alt ? ths.alt : 'Ulike'
        let loadingAttr =
          i == position - 1 ? 'fetchpriority="high"' : 'loading="lazy"'
        ths.media_type == 'video' ? ((imageUrl = ths.preview_image.src),
          (itemMainHtml = generateVideoHtml(ths.sources)))
          : (itemMainHtml = `
            <img src="${convertShopifyImageUrl(imageUrl, '880x')}" ${loadingAttr} class="img-big" data-fancybox="prozoom"
              data-src="${convertShopifyImageUrl(imageUrl, '880x')}" alt="${ths.alt}" media_type="${ths.media_type}">
          `)
        _productHtml += `<div class="results-reviews-product-big-item swiper-slide">${itemMainHtml}</div>`
        _productnavHtml += `<div class="results-reviews-product-small-item swiper-slide">
            <img src="${convertShopifyImageUrl(imageUrl, '80x')}" ${loadingAttr} alt="${ths.alt}" media_type="${ths.media_type}" class="img-sm">
          </div>`
      }
      $el.querySelector('.results-reviews-product-big-list').innerHTML = _productHtml
      $el.querySelector('.results-reviews-product-small-list').innerHTML = _productnavHtml
      initResultsReviewsSwiper()
      if (currentVariant.price != '' && currentVariant.page_price != '') {
        $el.querySelector('.results-reviews-product-price .n-price').innerHTML = currentVariant.page_price
        $el.querySelector('.results-reviews-product-price .d-price').innerHTML = currentVariant.price
        $el.querySelector('.results-reviews-product-add-btn .money').innerHTML = currentVariant.page_price
      }
      if (currentVariant.variantTitle != '') $el.querySelector('.product-info-new .product-meta__title').innerHTML = currentVariant.variantTitle
      if (currentVariant.describe != '') $el.querySelector('.results-reviews-product-desc').innerHTML = currentVariant.describe
      $el.querySelector('.results-reviews-product-add-btn').setAttribute('data-vid', currentVariant.vid)
      $el.querySelector('.results-reviews-product-btn .buy-buttons-pid').value = currentVariant.vid
    }

    // 统一事件监听器
    document.querySelector('.results-reviews-product-module')?.addEventListener('click', (event) => {
      // 变体切换逻辑
      const target = event.target.closest('.results-reviews-product-colours-item');
      if (target) {
        const vid = target.id;
        const name = target.getAttribute('name');
        if (target.classList.contains('active')) return;

        const coloursTitle = target.closest('.results-reviews-product-module')
          .querySelector('.results-reviews-colours-t span');

        if (coloursTitle) {
          coloursTitle.innerHTML = name;
        }

        // 移除同级元素的 active 类
        target.parentElement.querySelectorAll('.results-reviews-product-colours-item').forEach((item) => {
          item.classList.remove('active');
        });

        target.classList.add('active');

        generateHtmlForVariant(vid);
        return; // 避免继续执行下面的逻辑
      }

      // 复制折扣码逻辑
      const codeBtn = event.target.closest('.results-reviews-product-code-btn');
      if (codeBtn) {
        copyCodeFun('{{section.settings.text1}}', () => {
          codeBtn.innerHTML = '{{section.settings.text3}}';
          codeBtn.classList.add('font-b');
          setTimeout(() => {
            codeBtn.classList.remove('font-b');
            codeBtn.innerHTML = `
          <div class="results-reviews-product-code-p">{{ se_stts.text2 }}</div>
          <div class="results-reviews-product-code-txt">{{ se_stts.text1 }}</div>
        `;
          }, 3000);
        });
        return; // 避免继续执行下面的逻辑
      }
    });

  </script>
</body>

</html>